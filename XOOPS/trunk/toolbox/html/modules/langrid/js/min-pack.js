var Pair=Class.create(),StatusProcessor=Class.create(),EventDispatcher=Class.create(),BrowserIdentifier=Class.create();
Pair.prototype={initialize:function(a,b){this.first=a;this.second=b},setFirst:function(a){this.first=a},getFirst:function(){return this.first},setSecond:function(a){this.second=a},getSecond:function(){return this.second},car:function(){return this.getFirst()},cdr:function(){return this.getSecond()},caar:function(){return this.car().car()},cdar:function(){return this.cdr().car()},cadr:function(){return this.car().cdr()},cddr:function(){return this.cdr().cdr()},caaar:function(){return this.car().car().car()},
cadar:function(){return this.car().cdr().car()},caadr:function(){return this.car().car().cdr()},caddr:function(){return this.car().cdr().cdr()},cdaar:function(){return this.cdr().car().car()},cddar:function(){return this.cdr().cdr().car()},cdadr:function(){return this.cdr().car().cdr()},cdddr:function(){return this.cdr().cdr().cdr()}};
StatusProcessor.prototype={LIMITATION_ERROR_MESSAGE:"Service Limitation Error",LIMITATION_WARNING_MESSAGE:"Service Limitation Warning",initialize:function(a,b,d){this.response=a;this.status=this.response.status;this.message=this.response.message;this.contents=this.response.contents;this.warningMessage=d;this.errorMessage=b},check:function(){return this.status=="ERROR"?this.error():this.status=="WARNING"?this.warning():this.status=="OK"?this.ok():this.other()},error:function(){if(this.errorMessage!=
undefined)alert(this.errorMessage);else this.message!=undefined?alert(this.message):alert("Error");return false},warning:function(){if(this.warningMessage!=undefined)alert(this.warningMessage);else this.message!=undefined?alert(this.message):alert("Warning");return true},ok:function(){return true},other:function(){alert("Error: Unknown status error");return false},isLimitationError:function(){return this.message.include(this.LIMITATION_ERROR_MESSAGE)?true:false},isLimitationWarning:function(){return this.message.include(this.LIMITATION_WARNING_MESSAGE)?
true:false}};
EventDispatcher.prototype={click:function(a){if(document.createEvent){var b=document.createEvent("MouseEvents");b.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,false,false,0,null);a.dispatchEvent(b)}else{b=document.createEventObject();b.element=function(){return b.srcElement};a.fireEvent("onClick",b)}},change:function(a){if(document.createEvent){var b=document.createEvent("HTMLEvents");b.initEvent("change",true,true,window,0,0,0,0,0,false,false,false,false,0,null);a.dispatchEvent(b)}else{b=document.createEventObject();
b.element=function(){return b.srcElement};a.fireEvent("onChange",b)}}};
BrowserIdentifier={getBrowserName:function(){return/opera/i.test(navigator.userAgent)?"Opera":/msie/i.test(navigator.userAgent)?"Internet Explorer":/chrome/i.test(navigator.userAgent)?"Google Chrome":/safari/i.test(navigator.userAgent)?"Safari":/firefox/i.test(navigator.userAgent)?"Firefox":/gecko/i.test(navigator.userAgent)?"Gecko":navigator.userAgent},getBrowserDetail:function(){return navigator.userAgent},isIE:function(){return BrowserIdentifier.getBrowserName()=="Internet Explorer"},isIE6:function(){if(/msie 6/i.test(navigator.userAgent))return true},
isIE7:function(){if(/msie 7/i.test(navigator.userAgent))return true},isFF:function(){return BrowserIdentifier.getBrowserName()=="Firefox"},isFF2:function(){if(/firefox\/2/i.test(navigator.userAgent))return true},isFF3:function(){if(/firefox\/3/i.test(navigator.userAgent))return true},isSafari:function(){return BrowserIdentifier.getBrowserName()=="Safari"},isOpera:function(){return BrowserIdentifier.getBrowserName()=="Opera"},isChrome:function(){return BrowserIdentifier.getBrowserName()=="Google Chrome"},
isGecko:function(){return BrowserIdentifier.getBrowserName()=="Gecko"}};function getOrdinalNumber(a){var b=a%100,d=b%10;return(b-d)/10!=1?d==1?a+"st":d==2?a+"nd":d==3?a+"rd":a+"th":a+"th"}function handleHTTPStatusCode(a){var b="";switch(a.status){case 500:b="please report this error to Language Grid developers (playground@langrid.org).";break;case 502:b="please retry your action.";break;case 504:b="please check your proxy setting.";break}alert(a.status+" "+a.statusText+": "+b)}
Language={languageTagArray:[["sq","Albanian"],["ar","Arabic"],["bg","Bulgarian"],["ca","Catalan"],["zh-CN","Chinese(CN)"],["hr","Croatian"],["cs","Czech"],["da","Danish"],["nl","Dutch"],["en","English"],["et","Estonian"],["fi","Finnish"],["fr","French"],["gl","Galician"],["de","German"],["el","Greek"],["iw","Hebrew"],["hi","Hindi"],["hu","Hungarian"],["id","Indonesian"],["it","Italian"],["ja","Japanese"],["km","Khmer"],["ko","Korean"],["lv","Latvian"],["lt","Lithuanian"],["mt","Maltese"],["no","Norwegian"],["pl",
"Polish"],["pt","Portuguese"],["ro","Romanian"],["ru","Russian"],["sr","Serbian"],["sk","Slovak"],["sl","Slovenian"],["es","Spanish"],["sv","Swedish"],["th","Thai"],["tr","Turkish"],["uk","Ukrainian"],["vi","Vietnamese"],["zh","Chinese"],["zh-TW","Chinese(TW)"],["tl","Tagalog"]],_tagToIndex:[],_nameToIndex:[],_rtl:["ar","iw","he"],multilingualLanguageName:{ja:{bg:"\u30d6\u30eb\u30ac\u30ea\u30a2\u8a9e",de:"\u30c9\u30a4\u30c4\u8a9e",en:"\u82f1\u8a9e",es:"\u30b9\u30da\u30a4\u30f3\u8a9e",fr:"\u30d5\u30e9\u30f3\u30b9\u8a9e",
it:"\u30a4\u30bf\u30ea\u30a2\u8a9e",ja:"\u65e5\u672c\u8a9e",ko:"\u97d3\u56fd\u8a9e",pt:"\u30dd\u30eb\u30c8\u30ac\u30eb\u8a9e",zh:"\u4e2d\u56fd\u8a9e",nl:"\u30aa\u30e9\u30f3\u30c0\u8a9e",ru:"\u30ed\u30b7\u30a2\u8a9e"},en:{bg:"Bulgarian",de:"German",en:"English",es:"Spanish",fr:"French",it:"Italian",ja:"Japanese",km:"Khmer",ko:"Korean",pt:"Portuguese",zh:"Chinese",nl:"Dutch",ru:"Russian"}},nationalFlagArray:new Array(new Pair("en","img/gif/us.gif"),new Pair("es","img/gif/es.gif"),new Pair("ja","img/gif/jp.gif"),
new Pair("ko","img/gif/kr.gif"),new Pair("zh","img/gif/cn.gif"),new Pair("pt","img/gif/pt.gif")),separatorArray:{bg:new Array(".","?","!"),de:new Array(".","?","!"),en:new Array(".","?","!"),es:new Array(".","?","!"),fr:new Array(".","?","!"),it:new Array(".","?","!"),ja:new Array("\u3002","\uff0e",".","\uff1f","\uff01","?","!"),ko:new Array(".","?","!"),pt:new Array(".","?","!"),nl:new Array(".","?","!"),ru:new Array(".","?","!"),zh:new Array("\u3002","\uff1f","?","!","\uff01","\uff0e",".")},getNameByTag:function(a){var b=
this._tagToIndex[a];if(typeof b=="undefined")return a;return this.languageTagArray[b][1]},getMultilingualLanguageNameByTag:function(a,b){if(this.multilingualLanguageName[b][a])return this.multilingualLanguageName[b][a];return null},getTagByName:function(a){var b=this._nameToIndex[a];if(typeof b=="undefined")return a;return this.languageTagArray[b][0]},getTextDirection:function(a){if(this._rtl.indexOf(a)>=0)return"rtl";return"ltr"},getFlagSrcByTag:function(a){for(i=0;i<this.nationalFlagArray.length;i++)if(a==
this.nationalFlagArray[i].getFirst())return this.nationalFlagArray[i].getSecond();return a},getSeparatorArrayByTag:function(a){return this.separatorArray[a]==null||this.separatorArray[a]=="undefined"?new Array(".","?","!"):this.separatorArray[a]}};var i;for(i=0;i<Language.languageTagArray.length;i++){Language._tagToIndex[Language.languageTagArray[i][0]]=i;Language._nameToIndex[Language.languageTagArray[i][1]]=i}delete i;
ExceptionWordProcessor={exceptionWords:{dot:[new Array("a.a.O.","Abb.","a.c.","accel.","A.C.D.","A.D.","ad lib.","ahd.","Al.","a.m.","Anm.","Anon.","approx.","Apr.","Apt.","art.","Aug.","av.","Ave."),new Array("B.C.","Bd.","Bde.","bld.","bldg.","Blvd.","b.i.d.","bzw."),new Array("ca.","cf.","chap.","chaps.","cho.","Co.","c.o.d.","col.","col Ped.","Corp.","corp.","cresc."),new Array("D.C.","Dec.","decresc.","ders.","dept.","d.h.","dimin.","do.","Dr.","D.S."),new Array("ea.","ed.","eds.","e.g.","enc.",
"env.","e.o.m.","et al.","etc.","exp.","ex."),new Array("f.","Feb.","ff.","fig.","Fl.","figs.","fol.","Fri."),new Array("Gl.","govt."),new Array("Hg.","hg.","Hgg.","Hrsg.","hmhge.","hrsg."),new Array("ib.","ibid.","id.","i.e.","Inc.","inc.","inv.","i.q."),new Array("Jan.","Jg.","Jul.","Jun.","Jr."),[],new Array("l.","l. H.","ll.","Ln.","l.R","Ltd.","ltd."),new Array("M.","Mar.","M.D.","mdse.","Messers.","mhd.","M.O.","mo.","Mon.","m.p.h.","Mr.","Mrs.","Ms."),new Array("n.","N.A.","n.b.","n.d.","nd.",
"nhd.","Nm.","nn.","no.","nos.","Nov.","n.p.","Nr.","N.S.","n.s."),new Array("o.","o.B.","O.B.","Oct.","od.","o.J.","O.K.","o.O.","op.cit."),new Array("p.","par.","pars.","p.c.","Ph.D.","pl.","p.m.","pmk.","P.O.","p.o.","po.","policli.","P.P.","pp.","Prof.","p.s.","P.S.","pseud."),new Array("q.i.d.","qtr.","q.v."),new Array("r.","rall.","r.& v.","R.C.D.","Rd.","Re.","rec.","REG.","Ret.","r. H.","rinforz.","rinfz.","rit.","ritard.","Rm.","Rp."),new Array("S.","s.","s.a.","Sat.","sec.","Seg.","Sep.",
"Sept.","SFOR.","Sig.","s.l.","smorz.","Sp.","sp. A","spp.","so.","St.","st.","Sun.","Syn."),new Array("Taf.","T.B.","T.H.I.","Thu.","t.i.d.","trans.","transl.","Tue"),new Array("u.a.","U.K","U.S.A","U.S.","ut.","U.V.","UVs."),new Array("vgl.","viz.","Vol.","vol.","volz.","V.S.","vs."),new Array("W.C.","WC.","Wed.","wk.","wks."),[],new Array("y.","y.o.b."),new Array("Z.","z.B."),new Array("ubers.")],question:[],exclamation:[]},config:[{name:"dot",symbol:".",rule:"[[#dot]]"},{name:"question",symbol:"?",
rule:"[[#question]]"},{name:"exclamation",symbol:"!",rule:"[[#exclamation]]"}],encodeExceptionWord:function(a,b){try{for(i=0;i<this.config.size();i++)if(this.config[i].symbol==b){var d=this.exceptionWords[this.config[i].name].flatten();for(var c=b=0;(c=a.indexOf(" ",b))!=-1;){if(d.include(a.substring(b,c)))if(b==0||a.substring(b-1).startsWith(" ")){var e=a.substring(b,c),g=a.substring(0,b),h=a.substring(c),f=e.split(".");for(j=0;j<f.size()-1;j++)e=e.replace("#{symbol}".interpolate(this.config[i]),
this.config[i].rule);a=g.concat(e).concat(h)}b=c+1}if(d.include(a.substring(b)))if(b==0||a.substring(b-1).startsWith(" ")){e=a.substring(b);g=a.substring(0,b);f=e.split(".");for(j=0;j<f.size()-1;j++)e=e.replace("#{symbol}".interpolate(this.config[i]),this.config[i].rule);a=b==0?e:g.concat(e)}break}logger.info("I302","System","ExceptionWordProcessor.encodeExceptionWord",null,3);return a}catch(l){alert(a);logger.error("E302","System","ExceptionWordProcessor.encodeExceptionWord",a,3)}},decodeExceptionWord:function(a){for(i=
0;i<this.config.size();i++){var b=a.split(this.config[i].rule);for(j=0;j<b.size()-1;j++)a=a.replace(this.config[i].rule,this.config[i].symbol)}return a},encodeURL:function(a){try{var b=ExceptionWordProcessor.urlget(a),d=0;a.substring(d);for(var c=0;c<b.size();c+=1){d=a.indexOf(b[c]);for(var e=a.substring(0,d),g=a.substring(d+b[c].length),h=b[c],f=0;f<this.config.size();f+=1){var l=0,k=0;for(l=h.indexOf(this.config[f].symbol,l);l!=-1;){k++;l++;l=h.indexOf(this.config[f].symbol,l)}for(l=0;l<k;l+=1)h=
h.replace("#{symbol}".interpolate(this.config[f]),this.config[f].rule)}a=e+h+g}logger.info("I302","System","ExceptionWordProcessor.encodeURL",a,3);return a}catch(o){alert(a);logger.error("E302","System","ExceptionWordProcessor.encodeURL",a,3)}},encodeDecimalNumber:function(a){try{var b=a.match(/[0-9]*\.[0-9]+/g);if(b)for(i=0;i<b.size();i++){for(var d=a.indexOf(b[i]),c=a.substring(0,d),e=a.substring(d+b[i].length),g=b[i],h=0;h<this.config.size();h+=1){var f=0,l=0;for(f=g.indexOf(this.config[h].symbol,
f);f!=-1;){l++;f++;f=g.indexOf(this.config[h].symbol,f)}for(f=0;f<l;f+=1)g=g.replace("#{symbol}".interpolate(this.config[h]),this.config[h].rule)}a=c+g+e}logger.info("I302","System","ExceptionWordProcessor.encodeDecimalNumber",a,3);return a}catch(k){alert(a);logger.error("E302","System","ExceptionWordProcessor.encodeDecimalNumber",a,3)}},urlget:function(a){try{var b=a.match(/s?https?:\/\/[-_.!~*'()a-zA-Z0-9;\/?:@&=+$,%#]+/g);if(b==undefined){logger.info("I302","System","urlget",null,3);return[]}logger.info("I302",
"System","urlget",null,3);return b}catch(d){logger.error("E302","System","urlget",a,3)}}};function getDefaultMorphologicalAnalyzer(a){switch(a){case "ja":return"Mecab";case "ko":return"Klt";case "zh":return"ICTCLAS";case "en":return"TreeTagger";case "de":return"TreeTagger";case "fr":return"TreeTagger";case "it":return"TreeTagger";case "es":return"TreeTagger";case "nl":return"TreeTagger";case "ru":return"TreeTagger";case "bg":return"TreeTagger";case "pt":return"TreeTagger";default:return""}}
var langridWorkspace=null,settingTabControler=null,bBSAddPathWorkspace=null,bbsSettingView=null,addPathWorkspace=null,WebAddPathWorkspace=null,isInitializing=true;
Event.observe(window,"load",function(){this.bBSAddPathWorkspace=new BBSAddPathWorkspace;this.bbsSettingView=new BBSSettingView;this.addPathWorkspace=new AddPathWorkspace;this.WebAddPathWorkspace=new WebAddPathWorkspace;this.settingTabControler=new SettingTabControler;switch(NowTab){case "bbs":Element.visible($("tab2"))?this.settingTabControler._tab2Active():this.settingTabControler._tab4Active();break;case "text":this.settingTabControler._tab3Active();break;case "web":this.settingTabControler._tab5Active();
break}});var LangridWorkspace=Class.create();
LangridWorkspace.prototype={initialize:function(){},clearSelected:function(){$A($("translators").getElementsByTagName("div")).each(function(a){a.removeClassName("setting_btn_on");a.addClassName("setting_btn_off")})},saveSetting:function(a,b,d){var c=this,e={};e.serviceId=a;e.flg=b;e.mode=d;a=$H(e).toQueryString();new Ajax.Request("./ajax/save-setting-class.php",{method:"post",parameters:a,controller:c,onSuccess:function(g){g=g.responseText.evalJSON();g.status!="OK"&&alert(g.message)},onFailure:function(g){alert(g.responseText)},
onComplete:function(){}})},_getPositionOfBallon:function(a){var b=a.cumulativeOffset();a.up("div");$$("body")[0].cumulativeOffset();return new Pair(b[0]+10,b[1]+(a.getHeight()+2))},_getNowActiveDictionaryCount:function(){var a=0;$A($("dictionary").getElementsByTagName("div")).each(function(b){$(b).className=="setting_btn_on"&&a++});return a}};var SettingTabControler=Class.create();
SettingTabControler.prototype={initialize:function(){$("tab3")!=null&&this._initEvent()},_initEvent:function(){$("tab1").observe("click",this._tab1Active.bind(this));$("tab2").observe("click",this._tab2Active.bind(this));$("tab3").observe("click",this._tab3Active.bind(this));$("tab4").observe("click",this._tab4Active.bind(this));$("tab5").observe("click",this._tab5Active.bind(this))},_tab1Active:function(){if(this._clearMainPanel()){$("tab2-contents").hide();$("tab3-contents").hide();$("tab4-contents").hide();
$("tab5-contents").hide();$("tab1-contents").show();$("tab1").down("ul").className="tab_on";$("tab2").down("ul").className="tab_off";$("tab3").down("ul").className="tab_off";$("tab4").down("ul").className="tab_off";$("tab5").down("ul").className="tab_off"}},_tab2Active:function(){if(this._clearMainPanel()){$("tab1-contents").hide();$("tab3-contents").hide();$("tab4-contents").hide();$("tab5-contents").hide();$("tab2-contents").show();$("tab1").down("ul").className="tab_off";$("tab2").down("ul").className=
"tab_on";$("tab3").down("ul").className="tab_off";$("tab4").down("ul").className="tab_off";$("tab5").down("ul").className="tab_off";bBSAddPathWorkspace.start()}},_tab3Active:function(){if(this._clearMainPanel()){$("tab1-contents").hide();$("tab2-contents").hide();$("tab4-contents").hide();$("tab5-contents").hide();$("tab3-contents").show();$("tab1").down("ul").className="tab_off";$("tab2").down("ul").className="tab_off";$("tab3").down("ul").className="tab_on";$("tab4").down("ul").className="tab_off";
$("tab5").down("ul").className="tab_off";addPathWorkspace.start()}},_tab4Active:function(){if(this._clearMainPanel()){$("tab1-contents").hide();$("tab2-contents").hide();$("tab3-contents").hide();$("tab5-contents").hide();$("tab4-contents").show();$("tab1").down("ul").className="tab_off";$("tab2").down("ul").className="tab_off";$("tab3").down("ul").className="tab_off";$("tab4").down("ul").className="tab_on";$("tab5").down("ul").className="tab_off";bbsSettingView.start()}},_tab5Active:function(){if(this._clearMainPanel()){$("tab1-contents").hide();
$("tab2-contents").hide();$("tab3-contents").hide();$("tab4-contents").hide();$("tab5-contents").show();$("tab1").down("ul").className="tab_off";$("tab2").down("ul").className="tab_off";$("tab3").down("ul").className="tab_off";$("tab4").down("ul").className="tab_off";$("tab5").down("ul").className="tab_on";WebAddPathWorkspace.start()}},_clearMainPanel:function(){var a=false;if(isInitializing==false){$A(addPathWorkspace.pathPanelArray).each(function(b){if(Element.hasClassName(b._selfPanel,"nowedit"))if(!b._onCancelButtonClicked()){a=
true;throw $break;}});if(a)return false;$A(bBSAddPathWorkspace.pathPanelArray).each(function(b){if(Element.hasClassName(b._selfPanel,"nowedit"))if(!b._onCancelButtonClicked()){a=true;throw $break;}});if(a)return false}this._removeAllNode($("translation-path-root-panel"));this._removeAllNode($("translation-path-panel-wrapper"));this._removeAllNode($("translation-path-view-panel-wrapper"));this._removeAllNode($("translation-path-root-panel-web"));return true},_removeAllNode:function(a){if(a.hasChildNodes())for(var b=
a.lastChild;b;){var d=b;b=b.previousSibling;d.nodeName!=undefined&&a.removeChild(d)}},test:function(){}};function redirect2top(){$$(".nowedit").each(function(a){Element.removeClassName(a,"nowedit")});window.location.replace(Const.URL.TopPage)}var AddPathWorkspace=Class.create();
AddPathWorkspace.prototype={MainPanel:null,pathPanelArray:Array(),_DefaultSettings:null,initialize:function(){this.MainPanel=$("translation-path-root-panel");Event.observe(document,"dom:settingEditingThis",this._onSaveButtonToggle.bind(this));Event.observe(document,"dom:refreshMessage",this._refreshMessage.bind(this));Event.observe(window,"beforeunload",this._confirmChange.bind(this));this._DefaultSettings={global:Array(),local:Array(),temp:Array()}},_onSaveButtonToggle:function(){isInitializing==
false&&$A(this.pathPanelArray).each(function(a){$(a.elementsIds.panel+":message")&&Element.visible($(a.elementsIds.panel+":message"))&&Element.hide($(a.elementsIds.panel+":message"));if(Element.hasClassName(a._selfPanel,"nowedit")){var b=$(a.elementsIds.panel+":save"),d=$(a.elementsIds.panel+":save-img");if(b){a.updateEditElement();var c=a.validate();a=a._checkChange();if(c==null&&a){Element.removeClassName(b,"btn-disable");Element.addClassName(b,"btn");d.setAttribute("src",Const.Images.SaveOn)}else{Element.removeClassName(b,
"btn");Element.addClassName(b,"btn-disable");d.setAttribute("src",Const.Images.SaveOff)}}}})},_refreshMessage:function(){$("top-message-area")&&Element.visible($("top-message-area"))&&Element.hide($("top-message-area"));$A(this.pathPanelArray).each(function(a){$(a.elementsIds.panel+":message")&&Element.visible($(a.elementsIds.panel+":message"))&&Element.hide($(a.elementsIds.panel+":message"))})},_confirmChange:function(a){$A(this.pathPanelArray).each(function(b){if(Element.hasClassName(b._selfPanel,
"nowedit"))if(!Element.hasClassName($(b.elementsIds.panel+":save"),"btn-disable")){return a.returnValue=Const.Message.CancelConfirm;throw $break;}})},start:function(){isInitializing=true;this.__initializingView();this.pathPanelArray=[];this._loadSetting()},_showPanel:function(a,b){var d="S"+this.pathPanelArray.length,c=new TranslationPathPanel;c.makeTranslationPathPanel(d,b,this._langridServiceInformations,this.pathPanelArray,this._DefaultSettings,a);this.pathPanelArray.push(c)},_makeSearchPanel:function(){var a=
this.MainPanel,b=this._langridServiceInformations._sourceLanguageArray,d=document.createElement("div");d.id="search-area";d.appendChild(document.createTextNode(Const.Label.FilterFrom+" "));Element.addClassName(d,"div-search-area");var c=document.createElement("select");c.id="search-from";var e=document.createElement("option");e.setAttribute("value","");e.innerHTML="---";c.appendChild(e);$H(b).each(function(h){var f=document.createElement("option");f.setAttribute("value",h.key);f.innerHTML=h.value;
c.appendChild(f)});d.appendChild(c);d.appendChild(document.createTextNode(" "+Const.Label.FilterTo+" "));var g=document.createElement("select");g.id="search-to";e=document.createElement("option");e.setAttribute("value","");e.innerHTML="---";g.appendChild(e);$H(b).each(function(h){var f=document.createElement("option");f.setAttribute("value",h.key);f.innerHTML=h.value;g.appendChild(f)});d.appendChild(g);d.appendChild(document.createTextNode(" "));b=document.createElement("input");b.setAttribute("type",
"button");b.setAttribute("value",Const.Label.FlterButton);Event.observe(b,"click",this._filterPanel.bind(this),false);d.appendChild(b);b=document.createElement("span");b.id="matched-area";e=document.createElement("strong");e.id="match-count";b.appendChild(e);b.appendChild(document.createTextNode(" ["));e=document.createElement("a");e.innerHTML=Const.Label.DispAllPath;Event.observe(e,"click",this._resetFilter.bind(this));b.appendChild(e);b.appendChild(document.createTextNode("]"));Element.hide(b);
d.appendChild(b);a.appendChild(d)},_filterPanel:function(){var a=$("search-from").value,b=$("search-to").value;if(this.pathPanelArray.length)if(a!=""||b!=""){document.fire("dom:refreshMessage");var d=false;$A(this.pathPanelArray).each(function(e){if(Element.hasClassName(e._selfPanel,"nowedit"))if(!e._onCancelButtonClicked()){d=true;throw $break;}});if(!d){var c=0;$A(this.pathPanelArray).each(function(e){var g=false,h="",f="";h=f="";h=e.FirstLang;f=e.LastLang;if(this._comp_lang(a,b,h,f)){c++;g=true}if(!g&&
e.flow=="both"){f=f;h=h;if(this._comp_lang(a,b,f,h)){e.reverseValue();c++;g=true}}g?Element.show(e._selfPanel):Element.hide(e._selfPanel)}.bind(this));this._sortPanelArray();$("match-count").innerHTML=String(c)+" "+Const.Label.Matches;Element.removeClassName($("search-area"),"div-search-area");Element.addClassName($("search-area"),"div-search-area-executed");Element.show($("matched-area"))}}},_comp_lang:function(a,b,d,c){if(a!=""&&b!=""){if(d==a&&c==b)return true}else if(a!=""){if(d==a)return true}else if(b!=
"")if(c==b)return true;return false},_sortPanelArray:function(){if(this.pathPanelArray.length){this.__sort_array(this.pathPanelArray,0,this.pathPanelArray.length-1);for(var a=0;a<this.pathPanelArray.length;a++)$("list-area").appendChild(this.pathPanelArray[a]._selfPanel)}},__sort_array:function(a,b,d){for(var c=a[parseInt(b+(d-b)/2)],e=b-1,g=d+1;1;){for(;this.__cmp_data(a[++e],c)<0;);for(;this.__cmp_data(a[--g],c)>0;);if(e>=g)break;var h=a[e];a[e]=a[g];a[g]=h}b<e-1&&this.__sort_array(a,b,e-1);g+1<
d&&this.__sort_array(a,g+1,d);return a},__cmp_data:function(a,b){var d=a.getdataArrayValue(a._langridServiceInformations._sourceLanguageArray,a.FirstLang);a=a.getdataArrayValue(a._langridServiceInformations._targetLanguageArray,a.LastLang);var c=b.getdataArrayValue(b._langridServiceInformations._sourceLanguageArray,b.FirstLang);b=b.getdataArrayValue(b._langridServiceInformations._targetLanguageArray,b.LastLang);return d==c?a==b?0:a>b?1:-1:d>c?1:-1},_resetFilter:function(){var a=false;$A(this.pathPanelArray).each(function(b){if(Element.hasClassName(b._selfPanel,
"nowedit"))if(!b._onCancelButtonClicked()){a=true;throw $break;}});if(!a){$A(this.pathPanelArray).each(function(b){Element.show(b._selfPanel)});$("search-from").value="";$("search-to").value="";Element.removeClassName($("search-area"),"div-search-area-executed");Element.addClassName($("search-area"),"div-search-area");Element.hide($("matched-area"))}},_makeEditSettingArea:function(){var a=this.MainPanel,b=document.createElement("div");b.id="div-setting-area";var d=document.createElement("div");d.id=
"div-edit-default-area";var c=document.createElement("a");c.innerHTML='<img src="'+Const.Images.DefaultDict+'" id="img-def-dict"> '+Const.Label.EditDefaultDict;Event.observe(c,"click",this._onDefaultDictionaryButtonClicked.bind(this));d.appendChild(c);c=document.createElement("span");c.id="def-dic-count";d.appendChild(c);c=document.createElement("div");c.id="div-add-path-area";var e=document.createElement("a");Element.addClassName(e,"btn btn-addpath");e.innerHTML='<img src="'+Const.Images.AddPath+
'"> '+Const.Label.AddPath;Event.observe(e,"click",this._onAddPathButtonClicked.bind(this));c.appendChild(e);b.appendChild(d);b.appendChild(c);a.appendChild(b);b=document.createElement("div");b.id="new-path-area";Element.addClassName(b,"div-path-add-area");Element.hide(b);a.appendChild(b);b=document.createElement("div");b.id="top-message-area";Element.addClassName(b,"div-message-box");Element.hide(b);a.appendChild(b);this._setDictionaryCount()},_onDefaultDictionaryButtonClicked:function(){if(this.pathPanelArray.length){document.fire("dom:refreshMessage");
var a=false;$A(this.pathPanelArray).each(function(b){if(Element.hasClassName(b._selfPanel,"nowedit"))if(!b._onCancelButtonClicked()){a=true;throw $break;}});if(a)return}popupDictionaryPanel=new DictionaryPanel;popupDictionaryPanel.setParams(0,"default",this._langridServiceInformations._dictionaryServicesArray,this._langridServiceInformations._analyzerServicesArray,{lang1:"",langname1:"",lang2:"",langname2:""},this._DefaultSettings.global,this._DefaultSettings.local,this._DefaultSettings.temp,"","",
{global:Array(),local:Array(),temp:Array()},this);popupDictionaryPanel.showPane("edit")},_onAddPathButtonClicked:function(){var a=false;$A(this.pathPanelArray).each(function(d){if(Element.hasClassName(d._selfPanel,"nowedit"))if(!d._onCancelButtonClicked()){a=true;throw $break;}});if(!a){var b=new TranslationPathPanel;b.makeNewTranslationPathPanel($("list-area"),$("new-path-area"),this._langridServiceInformations,this.pathPanelArray,this._DefaultSettings);Element.addClassName(b._selfPanel,"nowedit");
this.pathPanelArray.push(b);Element.hide($("div-add-path-area"));Element.show($("new-path-area"));document.fire("dom:refreshMessage")}},_makePageTopArea:function(){var a=this.MainPanel,b=document.createElement("div");Element.addClassName(b,"div-pagetop-area");var d=document.createElement("a");Element.addClassName(d,"inner-link");d.innerHTML="<img src='./images/icon/icn_pagetop.gif' />"+Const.Label.ReturnTop;$(d).observe("click",this._gotoPageTop);b.appendChild(d);a.appendChild(b)},_gotoPageTop:function(){Element.scrollTo($("settings"))},
__initializingView:function(){$("setting_nowload").show();var a=this.MainPanel.childNodes.length-1;if(a>0)for(a=a;a>0;a--){var b=this.MainPanel.childNodes[a];b.nodeName!=undefined&&this.MainPanel.removeChild(b)}this.MainPanel.innerHTML="";$("setting_error_message").innerHTML=""},__initializedView:function(){this._sortPanelArray();$("setting_nowload").hide()},__initializedError:function(a){var b=[];b.push('<div style="color:#FF6347;">');b.push("<h2>ERROR:failed in initialization processing.</h2>");
b.push("<pre>"+a.description+"</pre>");b.push("</div>");$("setting_nowload").innerHTML=b.join("")},_loadSetting:function(){var a=this,b=$H({}).toQueryString();new Ajax.Request("./ajax/load-user-setting.php",{method:"post",parameters:b,controller:a,onSuccess:function(d){try{var c=d.responseText.evalJSON();if(c.status!="OK"){if(c.status=="SESSIONTIMEOUT"){redirect2top();return}alert(c.message);return}a._langridServiceInformations._sourceLanguageArray=c.contents.supportLangs.sourceLanguages;a._langridServiceInformations._targetLanguageArray=
c.contents.supportLangs.targetLanguages;a._langridServiceInformations._translationServicesArray=c.contents.translationServices;a._langridServiceInformations._analyzerServicesArray=c.contents.analyzeServices;a._langridServiceInformations._dictionaryServicesArray=c.contents.dictionaryServices;a._langridServiceInformations._currentSettings=c.contents.setting;var e=c.contents.DefaultDicts.bind_global_dict_ids;if(e!=null&&!e=="")a._DefaultSettings.global=e.split(",");var g=c.contents.DefaultDicts.bind_local_dict_ids;
if(g!=null&&!g=="")a._DefaultSettings.local=g.split(",");var h=c.contents.DefaultDicts.bind_user_dict_ids;if(h!=null&&!h=="")a._DefaultSettings.temp=h.split(",");a._makeSearchPanel();a._makeEditSettingArea();$("list-area")&&Element.remove($("list-area"));var f=document.createElement("div");f.id="list-area";$A(a._langridServiceInformations._currentSettings).each(function(k){a._showPanel(k,f)}.bind(a));a.MainPanel.appendChild(f);a._makePageTopArea();a.__initializedView()}catch(l){a.__initializedError(l)}isInitializing=
false}.bind(this),onFailure:function(d){$("setting_error_message").innerHTML="<pre>"+d.responseText+"</pre>"},onComplete:function(){}})},onDictionaryClickHandler:function(a,b,d,c){switch(c){case "GLOBAL":if(d==true)this._DefaultSettings.global.push(b);else{a=this._DefaultSettings.global.indexOf(b);a>-1&&this._DefaultSettings.global.splice(a,1)}this._DefaultSettings.global=this._DefaultSettings.global.sort();break;case "LOCAL":if(d==true)this._DefaultSettings.local.push(b);else{a=this._DefaultSettings.local.indexOf(b);
a>-1&&this._DefaultSettings.local.splice(a,1)}this._DefaultSettings.local=this._DefaultSettings.local.sort();break;case "USER":if(d==true)this._DefaultSettings.temp.push(b);else{a=this._DefaultSettings.temp.indexOf(b);a>-1&&this._DefaultSettings.temp.splice(a,1)}this._DefaultSettings.temp=this._DefaultSettings.temp.sort();break}},clearSelectDictionary:function(){this._DefaultSettings.global.clear();this._DefaultSettings.local.clear();this._DefaultSettings.temp.clear();this._DefaultSettings.morph_from=
"";this._DefaultSettings.morph_to=""},onDictionarySaveHandler:function(){if(this._DefaultSettings.global.length!=0||this._DefaultSettings.local.length!=0||this._DefaultSettings.temp.length!=0)$A(this.pathPanelArray).each(function(d){if(d.elementsIds.panel!="panel-N"&&d._primaryId==""){d._makeSaveDataAll();document.fire("dom:refreshMessage");throw $break;}});var a=this,b={};b.mode="ALL";b.global_dict_ids=this._DefaultSettings.global.join(",");b.local_dict_ids=this._DefaultSettings.local.join(",");
b.user_dict_ids=this._DefaultSettings.temp.join(",");b=$H(b).toQueryString();new Ajax.Request("./ajax/save-user-dict.php",{method:"post",parameters:b,controller:a,onSuccess:function(d){if(d.responseText.evalJSON().status=="SESSIONTIMEOUT")redirect2top();else isInitializing==false&&$A(a.pathPanelArray).each(function(c){if(a._DefaultSettings.global.length==0&&a._DefaultSettings.local.length==0&&a._DefaultSettings.temp.length==0)for(var e=0;e<=2;e++){if(c._dict_flags[e]==1){c._dict_flags[e]=0;if($(c.elementsIds.panel+
":viewdictimg_"+e)){c._global_dicts[e]=[];c._local_dicts[e]=[];c._temp_dicts[e]=[];c.updateViewPanel();$(c.elementsIds.panel+":viewdictimg_"+e).hide()}}}else for(e=0;e<=2;e++)if(c._dict_flags[e]==0||c._dict_flags[e]==1){c._dict_flags[e]=1;c._global_dicts[e]=a._DefaultSettings.global.join(",").split(",");c._local_dicts[e]=a._DefaultSettings.local.join(",").split(",");c._temp_dicts[e]=a._DefaultSettings.temp.join(",").split(",");c.updateViewPanel();if($(c.elementsIds.panel+":viewdictimg_"+e)){var g=
$(c.elementsIds.panel+":viewdictimg_"+e);Element.removeClassName(g,"btn-user-dic");Element.addClassName(g,"btn-def-dic");g.show()}}}.bind(a))}.bind(this),onFailure:function(d){$("setting_error_message").innerHTML="<per>"+d.responseText+"</pre>"},onComplete:function(){this._setDictionaryCount()}.bind(this)})},_setDictionaryCount:function(){if(this._DefaultSettings.global.length>0||this._DefaultSettings.local.length>0||this._DefaultSettings.temp.length>0){Element.show($("img-def-dict"));var a=this._DefaultSettings.global.length+
this._DefaultSettings.local.length+this._DefaultSettings.temp.length;$("def-dic-count").innerHTML="&nbsp;("+String(Const.Label.DictSelect).replace("%S",a)+")&nbsp;"}else{Element.hide($("img-def-dict"));$("def-dic-count").innerHTML="&nbsp;("+Const.Label.DictNoSelect+")&nbsp;"}},__util:function(a){a=a.split("2");return this._langridServiceInformations._sourceLanguageArray[a[0]]+"--\>"+this._langridServiceInformations._sourceLanguageArray[a[1]]},_langridServiceInformations:{}};
var BBSAddPathWorkspace=Class.create();Object.extend(BBSAddPathWorkspace.prototype,AddPathWorkspace.prototype);
Object.extend(BBSAddPathWorkspace.prototype,{MainPanel:null,pathPanelArray:Array(),_DefaultSettings:null,initialize:function(){this.MainPanel=$("translation-path-panel-wrapper");Event.observe(document,"dom:settingEditingThis",this._onSaveButtonToggle.bind(this));Event.observe(document,"dom:refreshMessage",this._refreshMessage.bind(this));Event.observe(window,"beforeunload",this._confirmChange.bind(this));this._DefaultSettings={global:Array(),local:Array(),temp:Array()}},_showPanel:function(a,b){var d=
this.pathPanelArray.length,c=new BBSPathPanel;c.makeTranslationPathPanel(d,b,this._langridServiceInformations,this.pathPanelArray,this._DefaultSettings,a);this.pathPanelArray.push(c)},__initializingView:function(){$("nowload").show();var a=this.MainPanel.childNodes.length-1;if(a>0)for(a=a;a>0;a--){var b=this.MainPanel.childNodes[a];b.nodeName!=undefined&&this.MainPanel.removeChild(b)}this.MainPanel.innerHTML="";$("error_message").innerHTML=""},__initializedView:function(){this._sortPanelArray();$("nowload").hide()},
__initializedError:function(a){var b=[];b.push('<div style="color:#FF6347;">');b.push("<h2>ERROR:failed in initialization processing.</h2>");b.push("<pre>"+a.description+"</pre>");b.push("</div>");$("nowload").innerHTML=b.join("")},_loadSetting:function(){var a=this,b=$H({}).toQueryString();new Ajax.Request("./ajax/load-bbs-setting.php",{method:"post",parameters:b,controller:a,onSuccess:function(d){try{var c=d.responseText.evalJSON();if(c.status!="OK"){if(c.status=="SESSIONTIMEOUT"){redirect2top();
return}alert(c.message);return}a._langridServiceInformations._sourceLanguageArray=c.contents.supportLangs.sourceLanguages;a._langridServiceInformations._targetLanguageArray=c.contents.supportLangs.targetLanguages;a._langridServiceInformations._translationServicesArray=c.contents.translationServices;a._langridServiceInformations._analyzerServicesArray=c.contents.analyzeServices;a._langridServiceInformations._dictionaryServicesArray=c.contents.dictionaryServices;a._langridServiceInformations._currentSettings=
c.contents.setting;var e=c.contents.DefaultDicts.bind_global_dict_ids;if(e!=null&&!e=="")a._DefaultSettings.global=e.split(",");var g=c.contents.DefaultDicts.bind_local_dict_ids;if(g!=null&&!g=="")a._DefaultSettings.local=g.split(",");var h=c.contents.DefaultDicts.bind_user_dict_ids;if(h!=null&&!h=="")a._DefaultSettings.temp=h.split(",");a._makeSearchPanel();a._makeEditSettingArea();$("list-area")&&Element.remove($("list-area"));var f=document.createElement("div");f.id="list-area";$A(a._langridServiceInformations._currentSettings).each(function(k){a._showPanel(k,
f)}.bind(a));a.MainPanel.appendChild(f);a._makePageTopArea();a.__initializedView()}catch(l){a.__initializedError(l)}isInitializing=false}.bind(this),onFailure:function(d){$("error_message").innerHTML="<pre>"+d.responseText+"</pre>"},onComplete:function(){}})},onDictionarySaveHandler:function(){var a=this,b={};b.mode="BBS";b.global_dict_ids=this._DefaultSettings.global.join(",");b.local_dict_ids=this._DefaultSettings.local.join(",");b.user_dict_ids=this._DefaultSettings.temp.join(",");b=$H(b).toQueryString();
new Ajax.Request("./ajax/save-bbs-dict.php",{method:"post",parameters:b,controller:a,onSuccess:function(d){if(d.responseText.evalJSON().status=="SESSIONTIMEOUT")redirect2top();else isInitializing==false&&$A(a.pathPanelArray).each(function(c){if(a._DefaultSettings.global.length==0&&a._DefaultSettings.local.length==0&&a._DefaultSettings.temp.length==0)for(var e=0;e<=2;e++){if(c._dict_flags[e]==1){c._dict_flags[e]=0;if($(c.elementsIds.panel+":viewdictimg_"+e)){c._global_dicts[e]=[];c._local_dicts[e]=
[];c._temp_dicts[e]=[];c.updateViewPanel();$(c.elementsIds.panel+":viewdictimg_"+e).hide()}}}else for(e=0;e<=2;e++)if(c._dict_flags[e]==0||c._dict_flags[e]==1){c._dict_flags[e]=1;c._global_dicts[e]=a._DefaultSettings.global.join(",").split(",");c._local_dicts[e]=a._DefaultSettings.local.join(",").split(",");c._temp_dicts[e]=a._DefaultSettings.temp.join(",").split(",");c.updateViewPanel();if($(c.elementsIds.panel+":viewdictimg_"+e)){var g=$(c.elementsIds.panel+":viewdictimg_"+e);Element.removeClassName(g,
"btn-user-dic");Element.addClassName(g,"btn-def-dic");g.show()}}}.bind(a))}.bind(this),onFailure:function(d){$("error_message").innerHTML="<per>"+d.responseText+"</pre>"},onComplete:function(){this._setDictionaryCount()}.bind(this)})},_onAddPathButtonClicked:function(){var a=false;$A(this.pathPanelArray).each(function(d){if(Element.hasClassName(d._selfPanel,"nowedit"))if(!d._onCancelButtonClicked()){a=true;throw $break;}});if(!a){var b=new BBSPathPanel;b.makeNewTranslationPathPanel($("list-area"),
$("new-path-area"),this._langridServiceInformations,this.pathPanelArray,this._DefaultSettings);Element.addClassName(b._selfPanel,"nowedit");this.pathPanelArray.push(b);Element.hide($("div-add-path-area"));Element.show($("new-path-area"));document.fire("dom:refreshMessage")}},_langridServiceInformations:{}});var BBSSettingView=Class.create();Object.extend(BBSSettingView.prototype,BBSAddPathWorkspace.prototype);
Object.extend(BBSSettingView.prototype,{initialize:function(){this.MainPanel=$("translation-path-view-panel-wrapper");this._DefaultSettings={global:Array(),local:Array(),temp:Array()}},_makeEditSettingArea:function(){var a=this.MainPanel,b=document.createElement("div");b.id="div-setting-area";var d=document.createElement("div");d.id="div-edit-default-area";var c=document.createElement("a");c.innerHTML='<img src="'+Const.Images.DefaultDict+'" id="img-def-dict"> '+Const.Label.ViewDefaultDict;Event.observe(c,
"click",this._onDefaultDictionaryViewClicked.bind(this));d.appendChild(c);c=document.createElement("span");c.id="def-dic-count";d.appendChild(c);b.appendChild(d);a.appendChild(b);this._setDictionaryCount()},_showPanel:function(a,b){var d=this.pathPanelArray.length,c=new TranslationPathPanelView;c.makeTranslationPathPanel(d,b,this._langridServiceInformations,this.pathPanelArray,this._DefaultSettings,a);this.pathPanelArray.push(c)},_onDefaultDictionaryViewClicked:function(){popupDictionaryPanel=new DictionaryPanel;
popupDictionaryPanel.setParams(0,"default",this._langridServiceInformations._dictionaryServicesArray,this._langridServiceInformations._analyzerServicesArray,{lang1:"",langname1:"",lang2:"",langname2:""},this._DefaultSettings.global,this._DefaultSettings.local,this._DefaultSettings.temp,"","",{global:Array(),local:Array(),temp:Array()},this);popupDictionaryPanel.showPane("view")},__initializingView:function(){$("div-page-message").hide();$("tab4-nowloading").show();var a=this.MainPanel.childNodes.length-
1;if(a>0)for(a=a;a>0;a--){var b=this.MainPanel.childNodes[a];b.nodeName!=undefined&&this.MainPanel.removeChild(b)}this.MainPanel.innerHTML="";$("error_message").innerHTML=""},__initializedView:function(){this._sortPanelArray();$("tab4-nowloading").hide();$("div-page-message").show()},__initializedError:function(a){var b=[];b.push('<div style="color:#FF6347;">');b.push("<h2>ERROR:failed in initialization processing.</h2>");b.push("<pre>"+a.description+"</pre>");b.push("</div>");$("tab4-nowloading").innerHTML=
b.join("")}});var TranslationPathPanel=Class.create();
TranslationPathPanel.prototype={_CONST_FLOW_OPS:{left:"&gt;",both:"&lt;&gt;"},_rootPanel:null,_addPanel:null,_PathArray:null,_selfPanel:null,elementsIds:{},_selectBoxElements:null,_checkBoxElements:null,_langridServiceInformations:null,_servicePanelElements:null,_blockPanelArray:null,_PanelMode:null,_preData:null,_default_Settings:null,_primaryId:null,_isDelete:null,_openedEdit:null,_saveButton:null,viewData:null,FirstLang:null,LastLang:null,flow:null,_global_dicts:null,_local_dicts:null,_temp_dicts:null,
_dict_flags:null,_morphemes_from:null,_morphemes_to:null,initialize:function(){this._global_dicts=new Array(Array(),Array(),Array());this._local_dicts=new Array(Array(),Array(),Array());this._temp_dicts=new Array(Array(),Array(),Array());this._dict_flags=new Array(Array(),Array(),Array());this._morphemes_from=new Array("","","");this._morphemes_to=new Array("","","")},errorView:function(a){if(a){Element.removeClassName($(this.elementsIds.panel+":message_box"),"div-message-box");Element.addClassName($(this.elementsIds.panel+
":message_box"),"div-message-box-alart")}else{Element.removeClassName($(this.elementsIds.panel+":message_box"),"div-message-box-alart");Element.addClassName($(this.elementsIds.panel+":message_box"),"div-message-box")}},showMessageBox:function(a){$(this.elementsIds.panel+":message_box").innerHTML=a;Element.show($(this.elementsIds.panel+":message"))},makeTranslationPathPanel:function(a,b,d,c,e,g){this._rootPanel=b;this._PathArray=c;this._default_Settings=e;this._langridServiceInformations=d;this._isDelete=
"0";this._initializeElementIds(a);this._PanelMode="edit";this._preData=a=this._initializeSettingData(g);this._initEvent(a)},makeTranslationPathPanel_A:function(a,b,d,c,e,g){this._rootPanel=b;this._PathArray=c;this._default_Settings=e;this._langridServiceInformations=d;this._isDelete="0";this._initializeElementIds(a);this._PanelMode="edit";this._preData=a=this._initializeSettingData(g);this._initEvent(a)},makeNewTranslationPathPanel:function(a,b,d,c,e){this._rootPanel=a;this._addPanel=b;this._PathArray=
c;this._default_Settings=e;this._langridServiceInformations=d;this._isDelete="0";this._initializeElementIds("N");this._PanelMode="new";a=this._initializeSettingData(null);for(b=0;b<=2;b++){a.dict_flags[b]=1;a.global_dicts[b]=e.global.join(",");a.local_dicts[b]=e.local.join(",");a.temp_dicts[b]=e.temp.join(",");this._dict_flags[b]=1;this._global_dicts[b]=this._copyArrayValue(e.global);this._local_dicts[b]=this._copyArrayValue(e.local);this._temp_dicts[b]=this._copyArrayValue(e.temp)}this._preData=
a;this._initNewEvent(a)},_initializeElementIds:function(a){this.IndexNumber=a;this.elementsIds={panel:"panel-"+a,view:"panel-"+a+":view",edit:"panel-"+a+":edit",lang1:"panel-"+a+":lang1",lang2:"panel-"+a+":lang2",lang3:"panel-"+a+":lang3",lang4:"panel-"+a+":lang4",flow1:"panel-"+a+":flow1",flow2:"panel-"+a+":flow2",flow3:"panel-"+a+":flow3"};this._selectBoxElements={lang1:null,lang2:null,lang3:null,lang4:null,flow1:null,flow2:null,flow3:null};this._checkBoxElements={checkbox1:null,checkbox2:null}},
_initializeSettingData:function(a){var b={lang1:"",lang2:"",lang3:"",lang4:"",service1:"",service2:"",service3:"",flow:"",global_dicts:Array("","",""),local_dicts:Array("","",""),temp_dicts:Array("","",""),morph_from:Array("","",""),morph_to:Array("","",""),dict_flags:Array("","","")};if(a==null){this._primaryId="";return b}var d=new Array("","","","");if(a.source_lang){if(a.translator_service_3){b.lang1=a.source_lang;b.lang2=a.inter_lang_1;b.lang3=a.inter_lang_2;b.lang4=a.target_lang;b.service1=
a.translator_service_1;b.service2=a.translator_service_2;b.service3=a.translator_service_3;d[0]=this._getValidAnalyzer(a.morph_analyzer1,a.lang1);d[1]=this._getValidAnalyzer(a.morph_analyzer2,a.lang2);d[2]=this._getValidAnalyzer(a.morph_analyzer3,a.lang3);d[3]=this._getValidAnalyzer(a.morph_analyzer4,a.lang4)}else if(a.translator_service_2){b.lang1=a.source_lang;b.lang2=a.inter_lang_1;b.lang3=a.target_lang;b.service1=a.translator_service_1;b.service2=a.translator_service_2;d[0]=this._getValidAnalyzer(a.morph_analyzer1,
a.lang1);d[1]=this._getValidAnalyzer(a.morph_analyzer2,a.lang2);d[2]=this._getValidAnalyzer(a.morph_analyzer3,a.lang3)}else{b.lang1=a.source_lang;b.lang2=a.target_lang;b.service1=a.translator_service_1;d[0]=this._getValidAnalyzer(a.morph_analyzer1,a.lang1);d[1]=this._getValidAnalyzer(a.morph_analyzer2,a.lang2)}b.flow=a.flow}else if(a.lang1){if(a.service3){b.lang1=a.lang1;b.lang2=a.lang2;b.lang3=a.lang3;b.lang4=a.lang4;b.service1=a.service1;b.service2=a.service2;b.service3=a.service3;d[0]=this._getValidAnalyzer(a.morph_analyzer1,
a.lang1);d[1]=this._getValidAnalyzer(a.morph_analyzer2,a.lang2);d[2]=this._getValidAnalyzer(a.morph_analyzer3,a.lang3);d[3]=this._getValidAnalyzer(a.morph_analyzer4,a.lang4)}else if(a.service2){b.lang1=a.lang1;b.lang2=a.lang2;b.lang3=a.lang3;b.service1=a.service1;b.service2=a.service2;d[0]=this._getValidAnalyzer(a.morph_analyzer1,a.lang1);d[1]=this._getValidAnalyzer(a.morph_analyzer2,a.lang2);d[2]=this._getValidAnalyzer(a.morph_analyzer3,a.lang3)}else{b.lang1=a.lang1;b.lang2=a.lang2;b.service1=a.service1;
d[0]=this._getValidAnalyzer(a.morph_analyzer1,a.lang1);d[1]=this._getValidAnalyzer(a.morph_analyzer2,a.lang2)}b.flow=a.flow}slist=$H(a);for(var c=0;c<=2;c++){if(slist.keys().indexOf("global_dict_"+String(c+1))>-1)if(slist.get("global_dict_"+String(c+1))!=null)b.global_dicts[c]=slist.get("global_dict_"+String(c+1));if(slist.keys().indexOf("local_dict_"+String(c+1))>-1)if(slist.get("local_dict_"+String(c+1))!=null)b.local_dicts[c]=slist.get("local_dict_"+String(c+1));if(slist.keys().indexOf("temp_dict_"+
String(c+1))>-1)if(slist.get("temp_dict_"+String(c+1))!=null)b.temp_dicts[c]=slist.get("temp_dict_"+String(c+1));if(slist.keys().indexOf("dict_flag_"+String(c+1))>-1)if(slist.get("dict_flag_"+String(c+1))!=null)b.dict_flags[c]=slist.get("dict_flag_"+String(c+1));b.morph_from[c]=d[c];b.morph_to[c]=d[c+1]}this._primaryId=a.id?String(a.id).substr(0,1)=="-"?"":a.id:"";for(c=0;c<=2;c++){this._global_dicts[c]=this._explode(b.global_dicts[c],",");this._local_dicts[c]=this._explode(b.local_dicts[c],",");
this._temp_dicts[c]=this._explode(b.temp_dicts[c],",");this._morphemes_from[c]=b.morph_from[c];this._morphemes_to[c]=b.morph_to[c];this._dict_flags[c]=b.dict_flags[c]}return b},_initEvent:function(a){var b=document.createElement("div");b.id=this.elementsIds.panel;Element.addClassName(b,"div-path-panel");var d=this._createViewPanel(a);a=this._createEditPanel(a);b.appendChild(this._createMessageArea());b.appendChild(d);b.appendChild(a);this._rootPanel.appendChild(b);this._selfPanel=b;this.updateEditElement()},
_initNewEvent:function(a){var b=document.createElement("div");b.id=this.elementsIds.panel;Element.addClassName(b,"div-path-panel");Element.addClassName(b,"nowedit");b.appendChild(this._createMessageArea());a=this._createEditPanel(a);b.appendChild(a);this._addPanel.appendChild(b);this._selfPanel=b;this.updateEditElement()},_createMessageArea:function(){var a=document.createElement("div");a.id=this.elementsIds.panel+":message";a.className="div-message-area";var b=document.createElement("div");b.className=
"div-message-box";b.id=this.elementsIds.panel+":message_box";b.innerHTML="";a.appendChild(b);Element.hide(a);return a},_createViewPanel:function(a){this.viewData=a;var b=document.createElement("div");b.id=this.elementsIds.view;b.className="trans-path";var d=this.getdataArrayValue(this._langridServiceInformations._sourceLanguageArray,a.lang1),c=this.getdataArrayValue(this._langridServiceInformations._targetLanguageArray,a.lang2),e=this.getdataArrayValue(this._langridServiceInformations._targetLanguageArray,
a.lang3),g=this.getdataArrayValue(this._langridServiceInformations._targetLanguageArray,a.lang4),h=this.getdataArrayValue(this._CONST_FLOW_OPS,a.flow),f=this.getSurviceNameFromArray(this._langridServiceInformations._translationServicesArray,a.service1),l=this.getSurviceNameFromArray(this._langridServiceInformations._translationServicesArray,a.service2),k=this.getSurviceNameFromArray(this._langridServiceInformations._translationServicesArray,a.service3),o=document.createElement("table");o.style.border=
"none";var p=document.createElement("tbody"),m=new Array(document.createElement("tr"),document.createElement("tr"));m[0].appendChild(this.makeTdObj("",this.makeDivObj(d,"lang-cell,lang-cell-strong")));m[0].appendChild(this.makeTdObj("",this.makeDivObj(h,"allow-cell")));document.createElement("td");document.createElement("div").className="div-dictionary-area";d=[];for(var n=0;n<=2;n++){d[n]=document.createElement("div");d[n].id=this.elementsIds.panel+":viewdictimg_"+n;if(a.dict_flags[n]==2){Element.addClassName(d[n],
"btn-user-dic");d[n].innerHTML=Const.Label.Custom;d[n].setAttribute("alt",Const.Label.Custom);d[n].setAttribute("title",Const.Label.Custom);d[n].show()}else{Element.addClassName(d[n],"btn-def-dic");d[n].innerHTML=Const.Label.Default;d[n].setAttribute("alt",Const.Label.Default);d[n].setAttribute("title",Const.Label.Default);d[n].show();a.dict_flags[n]==0&&d[n].hide();this._default_Settings.global.length==0&&this._default_Settings.local.length==0&&this._default_Settings.temp.length==0&&d[n].hide()}$(d[n]).observe("click",
this._onDictionaryViewClicked.bind(this))}m[1].appendChild(this.makeTdObj("&nbsp;"));m[1].appendChild(this.makeTdObj("&nbsp;"));m[1].appendChild(this.makeTdObj("",this.makeServiceViewObj(f,d[0])));this.FirstLang=a.lang1;if(e!=""){m[0].appendChild(this.makeTdObj("",this.makeDivObj(c,"lang-cell")));m[0].appendChild(this.makeTdObj("",this.makeDivObj(h,"allow-cell")));m[1].appendChild(this.makeTdObj("&nbsp;"));m[1].appendChild(this.makeTdObj("",this.makeServiceViewObj(l,d[1])));if(g!=""){this.LastLang=
a.lang4;m[0].appendChild(this.makeTdObj("",this.makeDivObj(e,"lang-cell")));m[0].appendChild(this.makeTdObj("",this.makeDivObj(h,"allow-cell")));m[0].appendChild(this.makeTdObj("",this.makeDivObj(g,"lang-cell,lang-cell-strong")));m[1].appendChild(this.makeTdObj("&nbsp;"));m[1].appendChild(this.makeTdObj("",this.makeServiceViewObj(k,d[2])))}else{this.LastLang=a.lang3;m[0].appendChild(this.makeTdObj("",this.makeDivObj(e,"lang-cell,lang-cell-strong")))}}else{this.LastLang=a.lang2;m[0].appendChild(this.makeTdObj("",
this.makeDivObj(c,"lang-cell,lang-cell-strong")))}this.flow=a.flow;p.appendChild(m[0]);p.appendChild(m[1]);o.appendChild(p);b.appendChild(o);a=document.createElement("div");a.className="edit-area";c=document.createElement("div");c.className="btn-edit";c.innerHTML="edit";$(b).observe("click",this._onEditButtonClicked.bind(this));a.appendChild(c);b.appendChild(a);return b},_createEditPanel:function(a){this._servicePanelElements=[];this._blockPanelArray=[];var b=document.createElement("div");b.id=this.elementsIds.edit;
b.className="trans-path-edit";this._PanelMode!="new"&&Element.hide(b);var d=this._createFirstBlockPanel(a),c=this._createSecondBlockPanel(a);a=this._createThirdBlockPanel(a);b.appendChild(d);b.appendChild(c);b.appendChild(a);this._blockPanelArray.push(d);this._blockPanelArray.push(c);this._blockPanelArray.push(a);d=document.createElement("br");d.style.clear="both";b.appendChild(d);d=this._createControllPanel();b.appendChild(d);return b},_createFirstBlockPanel:function(a){var b=document.createElement("div");
b.id=this.elementsIds.panel+":block-0";b.className="lang_block";var d=this.__createSelectBoxElem(this.elementsIds.lang1,this._langridServiceInformations._sourceLanguageArray,a.lang1,this._onLanguageChanged,true),c=this.__createSelectBoxElem(this.elementsIds.flow1,this._CONST_FLOW_OPS,a.flow,this._onLanguageChanged,false),e=this.__createSelectBoxElem(this.elementsIds.lang2,this._langridServiceInformations._targetLanguageArray,a.lang2,this._onLanguageChanged,true),g=document.createElement("table");
g.style.border="none";var h=document.createElement("tbody"),f=new Array(document.createElement("tr"),document.createElement("tr")),l=document.createElement("div");Element.addClassName(l,"lang-cell");l.appendChild(d);var k=document.createElement("div");Element.addClassName(k,"lang-cell");k.appendChild(e);f[0].appendChild(this.makeTdObj("",l));f[0].appendChild(this.makeTdObj("",c));f[0].appendChild(this.makeTdObj("",k));f[1].appendChild(this.makeTdObj("&nbsp;"));f[1].appendChild(this.makeTdObj("&nbsp;"));
l=this.makeTdObj("");var o=new ServicePanel(this._langridServiceInformations._targetLanguageArray);o.makeServicePanel(l,b.id,this._langridServiceInformations._translationServicesArray,"translator",d,e,c);o.setLanguageSelectors(d,e,c);o.setActiveServiceId(a.service1);k=document.createElement("div");k.id=this.elementsIds.panel+":adv_opt_area_0";Element.addClassName(k,"advanced-option-area");var p=document.createElement("a");p.id=this.elementsIds.panel+":adv_opt_0";Element.addClassName(p,"advanced-option");
p.appendChild(document.createTextNode(Const.Label.Advanced));var m=document.createElement("img");m.id=this.elementsIds.panel+":dictimg_0";m.setAttribute("src","./images/icon/icn_default_dictionary.gif");p.appendChild(m);$(p).observe("click",this._onDictionaryButtonClicked.bind(this));k.appendChild(p);l.appendChild(k);f[1].appendChild(l);this._selectBoxElements.lang1=d;this._selectBoxElements.lang2=e;this._selectBoxElements.flow1=c;var n=this;this._selectBoxElements.flow1.observe("change",function(q){q=
Event.element(q);$(n._selectBoxElements.flow2).value=q.value;$(n._selectBoxElements.flow3).value=q.value;this._onLanguageChanged()}.bind(this));d=document.createElement("td");c=document.createElement("a");c.id=this.elementsIds.panel+":plus1";Element.addClassName(c,"btn btn-mk");c.innerHTML='<img src="./images/icon/icn_plus.gif"/>';c.hide();d.appendChild(c);Event.observe(c,"click",function(){this._checkBoxElements.checkbox1.checked=true;this._blockPanelArray[1].show();$(this.elementsIds.panel+":flow_div_2").innerHTML=
this.getdataArrayValue(this._CONST_FLOW_OPS,$(this._selectBoxElements.flow1).value);$(this.elementsIds.panel+":flow_div_2").show();$(this.elementsIds.panel+":plus1").hide();$(this.elementsIds.panel+":minus1").show();this._onLanguageChanged();document.fire("dom:settingEditingThis")}.bind(this));c=document.createElement("div");c.id=this.elementsIds.panel+":flow_div_2";Element.addClassName(c,"allow-cell");c.innerHTML=this.getdataArrayValue(this._CONST_FLOW_OPS,a.flow);d.appendChild(c);c=o.makeAndBindTranslationCombinationCheckbox(this,
function(q,r){if(!o.getSetting()){alert(Const.Message.NoSelectedTranslator);return r.checked=false}if(r.checked)this._blockPanelArray[1].show();else{this._checkBoxElements.checkbox2.checked=false;this._blockPanelArray[1].hide();this._servicePanelElements[1].clearSelection();this._selectBoxElements.lang3.value="";this._blockPanelArray[2].hide();this._servicePanelElements[2].clearSelection();this._selectBoxElements.lang4.value=""}});$(c).checked=true;$(c).hide();this._checkBoxElements.checkbox1=$(c);
this._servicePanelElements.push(o);d.appendChild(c);f[0].appendChild(d);f[1].appendChild(this.makeTdObj(""));h.appendChild(f[0]);h.appendChild(f[1]);g.appendChild(h);b.appendChild(g);this._checkBoxElements.checkbox1.checked=a.service2?true:false;return b},_createSecondBlockPanel:function(a){var b=document.createElement("div");b.id=this.elementsIds.panel+":block-1";b.className="lang_block";var d=this.__createSelectBoxElem(this.elementsIds.flow2,this._CONST_FLOW_OPS,a.flow,this._onLanguageChanged,false);
d.setAttribute("disabled","disabled");d.style.backgroundColor="#fff";d.style.color="#000";d.hide();var c=this.__createSelectBoxElem(this.elementsIds.lang3,this._langridServiceInformations._targetLanguageArray,a.lang3,this._onLanguageChanged,true),e=document.createElement("table");e.style.border="none";var g=document.createElement("tbody"),h=new Array(document.createElement("tr"),document.createElement("tr")),f=document.createElement("div");Element.addClassName(f,"lang-cell");f.appendChild(c);var l=
document.createElement("td");l.appendChild(d);var k=document.createElement("a");k.id=this.elementsIds.panel+":minus1";Element.addClassName(k,"btn btn-mk");k.innerHTML='<img src="./images/icon/icn_minus.gif"/>';l.appendChild(k);Event.observe(k,"click",function(){if(!Element.visible(this._blockPanelArray[2])){this._checkBoxElements.checkbox1.checked=false;this._checkBoxElements.checkbox2.checked=false;this._blockPanelArray[1].hide();this._servicePanelElements[1].clearSelection();this._selectBoxElements.lang3.value=
"";this._blockPanelArray[2].hide();this._servicePanelElements[2].clearSelection();this._selectBoxElements.lang4.value="";$(this.elementsIds.panel+":flow_div_3").hide();$(this.elementsIds.panel+":flow_div_2").hide();$(this.elementsIds.panel+":plus1").show();$(this.elementsIds.panel+":minus1").hide();this._onLanguageChanged();document.fire("dom:settingEditingThis")}}.bind(this));h[0].appendChild(l);h[0].appendChild(this.makeTdObj("",f));this._selectBoxElements.lang3=c;this._selectBoxElements.flow2=
d;h[1].appendChild(this.makeTdObj("&nbsp;"));d=this.makeTdObj("");var o=new ServicePanel(this._langridServiceInformations._targetLanguageArray);o.makeServicePanel(d,b.id,this._langridServiceInformations._translationServicesArray,"translator",this._selectBoxElements.lang2,c,this._selectBoxElements.flow1);o.setLanguageSelectors(this._selectBoxElements.lang2,c,this._selectBoxElements.flow1);o.setActiveServiceId(a.service2);c=document.createElement("div");c.id=this.elementsIds.panel+":adv_opt_area_1";
Element.addClassName(c,"advanced-option-area");f=document.createElement("a");f.id=this.elementsIds.panel+":adv_opt_1";Element.addClassName(f,"advanced-option");f.appendChild(document.createTextNode(Const.Label.Advanced));l=document.createElement("img");l.id=this.elementsIds.panel+":dictimg_1";l.setAttribute("src","./images/icon/icn_default_dictionary.gif");f.appendChild(l);$(f).observe("click",this._onDictionaryButtonClicked.bind(this));c.appendChild(f);d.appendChild(c);h[1].appendChild(d);c=document.createElement("td");
d=document.createElement("a");d.id=this.elementsIds.panel+":plus2";Element.addClassName(d,"btn btn-mk");d.innerHTML='<img src="./images/icon/icn_plus.gif"/>';d.hide();c.appendChild(d);Event.observe(d,"click",function(){this._checkBoxElements.checkbox2.checked=true;this._blockPanelArray[2].show();$(this.elementsIds.panel+":flow_div_3").innerHTML=this.getdataArrayValue(this._CONST_FLOW_OPS,$(this._selectBoxElements.flow1).value);$(this.elementsIds.panel+":flow_div_3").show();$(this.elementsIds.panel+
":plus2").hide();$(this.elementsIds.panel+":minus2").show();this._onLanguageChanged();document.fire("dom:settingEditingThis")}.bind(this));d=document.createElement("div");d.id=this.elementsIds.panel+":flow_div_3";Element.addClassName(d,"allow-cell");d.innerHTML=this.getdataArrayValue(this._CONST_FLOW_OPS,a.flow);c.appendChild(d);d=o.makeAndBindTranslationCombinationCheckbox(this,function(p,m){if(!o.getSetting()){alert(Const.Message.NoSelectedTranslator);return m.checked=false}if(m.checked)this._blockPanelArray[2].show();
else{this._blockPanelArray[2].hide();this._servicePanelElements[2].clearSelection();this._selectBoxElements.lang4.value=""}});$(d).hide();this._checkBoxElements.checkbox2=$(d);this._servicePanelElements.push(o);c.appendChild(d);h[0].appendChild(c);h[1].appendChild(this.makeTdObj(""));g.appendChild(h[0]);g.appendChild(h[1]);e.appendChild(g);b.appendChild(e);this._checkBoxElements.checkbox2.checked=a.service3?true:false;return b},_createThirdBlockPanel:function(a){var b=document.createElement("div");
b.id=this.elementsIds.panel+":block-2";b.className="lang_block";var d=this.__createSelectBoxElem(this.elementsIds.flow3,this._CONST_FLOW_OPS,a.flow,this._onLanguageChanged,false);d.setAttribute("disabled","disabled");d.style.backgroundColor="#fff";d.style.color="#000";d.hide();var c=this.__createSelectBoxElem(this.elementsIds.lang4,this._langridServiceInformations._targetLanguageArray,a.lang4,this._onLanguageChanged,true),e=document.createElement("table");e.style.border="none";var g=document.createElement("tbody"),
h=new Array(document.createElement("tr"),document.createElement("tr")),f=document.createElement("div");Element.addClassName(f,"lang-cell");f.appendChild(c);var l=document.createElement("td");l.appendChild(d);var k=document.createElement("a");k.id=this.elementsIds.panel+":minus2";Element.addClassName(k,"btn btn-mk");k.innerHTML='<img src="./images/icon/icn_minus.gif"/>';l.appendChild(k);Event.observe(k,"click",function(){this._checkBoxElements.checkbox2.checked=false;this._blockPanelArray[2].hide();
this._servicePanelElements[2].clearSelection();this._selectBoxElements.lang4.value="";$(this.elementsIds.panel+":flow_div_3").hide();$(this.elementsIds.panel+":plus2").show();$(this.elementsIds.panel+":minus2").hide();this._onLanguageChanged();document.fire("dom:settingEditingThis")}.bind(this));h[0].appendChild(l);h[0].appendChild(this.makeTdObj("",f));this._selectBoxElements.lang4=c;this._selectBoxElements.flow3=d;h[1].appendChild(this.makeTdObj("&nbsp;"));d=this.makeTdObj("");f=new ServicePanel(this._langridServiceInformations._targetLanguageArray);
f.makeServicePanel(d,b.id,this._langridServiceInformations._translationServicesArray,"translator",this._selectBoxElements.lang3,c,this._selectBoxElements.flow1);f.setLanguageSelectors(this._selectBoxElements.lang3,c,this._selectBoxElements.flow1);f.setActiveServiceId(a.service3);c=document.createElement("div");c.id=this.elementsIds.panel+":adv_opt_area_2";Element.addClassName(c,"advanced-option-area");l=document.createElement("a");l.id=this.elementsIds.panel+":adv_opt_2";Element.addClassName(l,"advanced-option");
l.appendChild(document.createTextNode(Const.Label.Advanced));k=document.createElement("img");k.id=this.elementsIds.panel+":dictimg_2";k.setAttribute("src","./images/icon/icn_default_dictionary.gif");l.appendChild(k);$(l).observe("click",this._onDictionaryButtonClicked.bind(this));c.appendChild(l);d.appendChild(c);h[1].appendChild(d);a.service3?$(b).show():$(b).hide();this._servicePanelElements.push(f);g.appendChild(h[0]);g.appendChild(h[1]);e.appendChild(g);b.appendChild(e);return b},_createControllPanel:function(){var a=
document.createElement("div");a.id=this.elementsIds.panel+":controll";Element.addClassName(a,"trans-path-edit-area");var b=document.createElement("div");Element.addClassName(b,"left-area");var d=document.createElement("div");Element.addClassName(d,"right-area");if(this._PanelMode!="new"){var c=document.createElement("a");c.id=this.elementsIds.panel+":del";Element.addClassName(c,"btn btn-delete");c.innerHTML+='<img src="./images/icon/icn_delete.gif" />'+Const.Label.DeleteButton;$(c).observe("click",
this._onDeleteButtonClicked.bind(this));d.appendChild(c)}c=document.createElement("a");c.id=this.elementsIds.panel+":cancel";Element.addClassName(c,"btn btn-cancel");c.innerHTML+='<img src="./images/icon/icn_cancel.gif" />'+Const.Popup.BTN_CANCEL;$(c).observe("click",this._onCancelButtonClicked.bind(this));d.appendChild(c);c=document.createElement("a");c.id=this.elementsIds.panel+":save";Element.addClassName(c,"btn-disable btn-save");var e=document.createElement("img");e.id=this.elementsIds.panel+
":save-img";e.setAttribute("src","./images/icon/icn_save_disable.gif");c.appendChild(e);this._PanelMode!="new"?c.appendChild(document.createTextNode(Const.Label.Save)):c.appendChild(document.createTextNode(Const.Label.AddButton));$(c).observe("click",this._onSaveButtonClicked.bind(this));this._saveButton=c;d.appendChild(c);a.appendChild(b);a.appendChild(d);return a},__createSelectBoxElem:function(a,b,d,c,e){var g=document.createElement("select");g.id=a;if(e){a=document.createElement("option");a.setAttribute("value",
"");a.innerHTML="---";g.appendChild(a)}$H(b).each(function(h){var f=document.createElement("option");f.setAttribute("value",h.key);f.innerHTML=h.value;g.appendChild(f)});g.value=d;c!=null&&Event.observe(g,"change",c.bind(this));return g},getdataArrayValue:function(a,b){var d="";a=$H(a);if(b!=""&&a)if(a.get(b))d=a.get(b);return d},getSurviceNameFromArray:function(a,b){ret="";a.each(function(d){if(d.service_id==b)ret=d.service_name});return ret},_onLanguageChanged:function(){this.updateEditElement()},
updateEditElement:function(){try{if(isInitializing==false)if(this._selfPanel!=null&&$(this._selectBoxElements.lang3)!=null){$(this.elementsIds.panel+":plus1").hide();$(this.elementsIds.panel+":plus2").hide();$(this.elementsIds.panel+":flow_div_2").hide();$(this.elementsIds.panel+":flow_div_3").hide();$(this.elementsIds.panel+":minus1").hide();$(this.elementsIds.panel+":minus2").hide();$(this.elementsIds.panel+":adv_opt_area_0").hide();$(this.elementsIds.panel+":adv_opt_area_1").hide();$(this.elementsIds.panel+
":adv_opt_area_2").hide();$(this._blockPanelArray[1]).hide();$(this._blockPanelArray[2]).hide();$(this._selectBoxElements.lang1).removeAttribute("disabled");$(this._selectBoxElements.lang2).removeAttribute("disabled");$(this._selectBoxElements.lang3).removeAttribute("disabled");$(this._selectBoxElements.flow1).removeAttribute("disabled");if($(this._selectBoxElements.lang1).value==""){$(this._selectBoxElements.lang2).value="";$(this._selectBoxElements.lang2).setAttribute("disabled","disabled");this._servicePanelElements[0].disabled=
false}else{$(this._selectBoxElements.lang2).value!=""&&$(this.elementsIds.panel+":adv_opt_area_0").show();if(this._servicePanelElements[0].getSetting()){if(this._checkBoxElements.checkbox1.checked){$(this._selectBoxElements.lang1).setAttribute("disabled","disabled");$(this._selectBoxElements.flow1).setAttribute("disabled","disabled");$(this._selectBoxElements.lang2).setAttribute("disabled","disabled");this._servicePanelElements[0].disabled=true;$(this.elementsIds.panel+":minus1").show();$(this.elementsIds.panel+
":flow_div_2").show();this._blockPanelArray[1].show()}else{$(this._selectBoxElements.lang1).removeAttribute("disabled");$(this._selectBoxElements.flow1).removeAttribute("disabled");$(this._selectBoxElements.lang2).removeAttribute("disabled");this._servicePanelElements[0].disabled=false;$(this._selectBoxElements.lang2).value!=""&&$(this.elementsIds.panel+":plus1").show();$(this._blockPanelArray[1]).hide()}$(this._selectBoxElements.lang3).value!=""&&$(this.elementsIds.panel+":adv_opt_area_1").show();
if(this._servicePanelElements[1].getSetting()){if(this._checkBoxElements.checkbox2.checked){$(this.elementsIds.panel+":minus2").show();Element.removeClassName($(this.elementsIds.panel+":minus1"),"btn");Element.addClassName($(this.elementsIds.panel+":minus1"),"btn-disable");Element.removeClassName($(this.elementsIds.panel+":minus1"),"btn-mk");Element.addClassName($(this.elementsIds.panel+":minus1"),"btn-mk-disable");$(this.elementsIds.panel+":flow_div_3").show();$(this._selectBoxElements.lang3).setAttribute("disabled",
"disabled");this._servicePanelElements[1].disabled=true;this._blockPanelArray[2].show()}else{if($(this._selectBoxElements.lang3).value!=""){$(this.elementsIds.panel+":plus2").show();Element.removeClassName($(this.elementsIds.panel+":minus1"),"btn-disable");Element.addClassName($(this.elementsIds.panel+":minus1"),"btn");Element.removeClassName($(this.elementsIds.panel+":minus1"),"btn-mk-disable");Element.addClassName($(this.elementsIds.panel+":minus1"),"btn-mk")}this._servicePanelElements[1].disabled=
false;$(this._selectBoxElements.lang3).removeAttribute("disabled");$(this._blockPanelArray[2]).hide()}$(this._selectBoxElements.lang4).value!=""&&$(this.elementsIds.panel+":adv_opt_area_2").show();this._servicePanelElements[2].getSetting()}}}}}catch(a){alert(a.message)}},_onDeleteButtonClicked:function(){var a=this.getdataArrayValue(this._langridServiceInformations._sourceLanguageArray,this.FirstLang),b=this.getdataArrayValue(this._langridServiceInformations._targetLanguageArray,this.LastLang),d=
this.getdataArrayValue(this._CONST_FLOW_OPS,this._preData.flow),c=Const.Message.ConfirmDeleteBBS;c=c.replace("%SRC",a);c=c.replace("%FLW",d.unescapeHTML());c=c.replace("%TGT",b);if(confirm(c)){this._selfPanel.hide();this._isDelete="yes";var e=false;$A(this._PathArray).each(function(g){if(g.elementsIds.panel!="panel-N"&&g._primaryId==""){e=true;throw $break;}});e?this._makeSaveDataAll():this._makeSaveData(this)}},_onSaveButtonClicked:function(a){if(!Element.hasClassName(Event.findElement(a,"a"),"btn-disable")){a=
"";var b=Array();$A(this._PathArray).each(function(e){e.errorView(false);e!=this&&Element.visible(e._selfPanel)&&b.push(e.getLanguagePair())}.bind(this));b=b.flatten();a=this.getLanguagePair();for(var d=0;d<a.length;d++)if(b.indexOf(a[d])>-1){a=Const.Message.SaveOnError2+" ["+this.__util(a[d])+"]";Element.scrollTo($(this._selfPanel));this.errorView(true);this.showMessageBox(a);return}var c=false;$A(this._PathArray).each(function(e){if(e.elementsIds.panel!="panel-N"&&e._primaryId==""){c=true;throw $break;
}});c?this._makeSaveDataAll():this._makeSaveData(this)}},_makeSaveData:function(a){var b=Array();Array();a=this;index=a.elementsIds.panel;a=a.getSetting();(a="index="+index+"&"+a)&&b.push(a);this._saveSetting(b)},_makeSaveDataAll:function(){var a=Array();$A(this._PathArray).each(function(b){var d=b.getSetting();(d="index="+b.elementsIds.panel+"&"+d)&&a.push(d)}.bind(this));this._saveSetting(a)},_saveSetting:function(a){var b=this,d={};d.mode="ALL";$A(a).each(function(c,e){d["data["+e+"]"]=c});a=$H(d).toQueryString();
new Ajax.Request("./ajax/save-user-setting.php",{method:"post",parameters:a,asynchronous:false,controller:b,onSuccess:function(c){var e=c.responseText.evalJSON();if(e.status=="SESSIONTIMEOUT")redirect2top();else{this.errorView(false);c=this._buildeData();var g=this.getdataArrayValue(this._langridServiceInformations._sourceLanguageArray,c.lang1),h=this.getdataArrayValue(this._CONST_FLOW_OPS,c.flow);c=c.lang4!=""?this.getdataArrayValue(this._langridServiceInformations._sourceLanguageArray,c.lang4):
c.lang3!=""?this.getdataArrayValue(this._langridServiceInformations._sourceLanguageArray,c.lang3):this.getdataArrayValue(this._langridServiceInformations._sourceLanguageArray,c.lang2);var f=this._PanelMode=="new"?Const.Message.AddedMessage:Const.Message.SavedMessage;f=f.replace("%SRC",g);f=f.replace("%FLW",h);f=f.replace("%TGT",c);$A(b._PathArray).each(function(l){l.errorView(false);e.contents[l.elementsIds.panel]&&e.contents[l.elementsIds.panel]!="undefined"&&e.contents[l.elementsIds.panel]!=""&&
l.updatePrimaryId(e.contents[l.elementsIds.panel])});if(this._PanelMode=="new"){$("top-message-area").innerHTML=f;$("top-message-area").show();c=this._buildeData();g="S"+this._PathArray.length;h=new TranslationPathPanel;h.makeTranslationPathPanel_A(g,this._rootPanel,this._langridServiceInformations,this._PathArray,this._default_Settings,c);this._PathArray.push(h);for(c=0;c<this._PathArray.length;c++)if(this._PathArray[c]==this){this._PathArray.splice(c,1);break}this._sortPanelArray()}else if(this._isDelete==
"yes")for(c=0;c<this._PathArray.length;c++){if(this._PathArray[c]==this){this._PathArray.splice(c,1);break}}else{this.updateViewPanel();this.showMessageBox(f)}}}.bind(this),onFailure:function(c){$("setting_error_message").innerHTML="<per>"+c.responseText+"</pre>"},onComplete:function(){$$(".nowedit").each(function(c){$(c.id+":edit")&&$(c.id+":edit").hide();$(c.id+":view")&&$(c.id+":view").show();Element.removeClassName(c,"nowedit");var e=$(c.id+":save");Element.removeClassName(e,"btn");Element.addClassName(e,
"btn-disable");$(c.id+":save-img").setAttribute("src","./images/icon/icn_save_disable.gif")});if(this._PanelMode=="new"){this._addPanel.innerHTML="";this._addPanel.hide();$("div-add-path-area").show()}addPathWorkspace._resetFilter()}.bind(this)})},updateViewPanel:function(){var a=this._initializeSettingData(this._buildeData());this._preData=a;a=this._createViewPanel(a);var b=$(this.elementsIds.view);this._selfPanel.replaceChild(a,b)},reverseValue:function(){var a={lang1:"",lang2:"",lang3:"",lang4:"",
service1:"",service2:"",service3:"",flow:this._preData.flow,global_dicts:Array("","",""),local_dicts:Array("","",""),temp_dicts:Array("","",""),morph_from:Array("","",""),morph_to:Array("","",""),dict_flags:Array("","","")};if(this._preData.service3!=""){a.lang1=this._preData.lang4;a.lang2=this._preData.lang3;a.lang3=this._preData.lang2;a.lang4=this._preData.lang1;a.service1=this._preData.service3;a.service2=this._preData.service2;a.service3=this._preData.service1;a.global_dicts[0]=this._preData.global_dicts[2];
a.global_dicts[1]=this._preData.global_dicts[1];a.global_dicts[2]=this._preData.global_dicts[0];a.local_dicts[0]=this._preData.local_dicts[2];a.local_dicts[1]=this._preData.local_dicts[1];a.local_dicts[2]=this._preData.local_dicts[0];a.temp_dicts[0]=this._preData.temp_dicts[2];a.temp_dicts[1]=this._preData.temp_dicts[1];a.temp_dicts[2]=this._preData.temp_dicts[0];a.dict_flags[0]=this._preData.dict_flags[2];a.dict_flags[1]=this._preData.dict_flags[1];a.dict_flags[2]=this._preData.dict_flags[0];a.morph_from[0]=
this._preData.morph_to[2];a.morph_from[1]=this._preData.morph_to[1];a.morph_from[2]=this._preData.morph_to[0];a.morph_to[0]=this._preData.morph_from[2];a.morph_to[1]=this._preData.morph_from[1];a.morph_to[2]=this._preData.morph_from[0]}else if(this._preData.service2!=""){a.lang1=this._preData.lang3;a.lang2=this._preData.lang2;a.lang3=this._preData.lang1;a.service1=this._preData.service2;a.service2=this._preData.service1;a.global_dicts[0]=this._preData.global_dicts[1];a.global_dicts[1]=this._preData.global_dicts[0];
a.local_dicts[0]=this._preData.local_dicts[1];a.local_dicts[1]=this._preData.local_dicts[0];a.temp_dicts[0]=this._preData.temp_dicts[1];a.temp_dicts[1]=this._preData.temp_dicts[0];a.dict_flags[0]=this._preData.dict_flags[1];a.dict_flags[1]=this._preData.dict_flags[0];a.morph_from[0]=this._preData.morph_from[2];a.morph_from[1]=this._preData.morph_from[1];a.morph_from[2]=this._preData.morph_from[0];a.morph_to[0]=this._preData.morph_from[1];a.morph_to[1]=this._preData.morph_from[0]}else{a.lang1=this._preData.lang2;
a.lang2=this._preData.lang1;a.service1=this._preData.service1;a.global_dicts[0]=this._preData.global_dicts[0];a.local_dicts[0]=this._preData.local_dicts[0];a.temp_dicts[0]=this._preData.temp_dicts[0];a.dict_flags[0]=this._preData.dict_flags[0];a.morph_from[0]=this._preData.morph_from[1];a.morph_from[1]=this._preData.morph_from[0];a.morph_to[0]=this._preData.morph_from[0]}for(var b=0;b<=2;b++){this._global_dicts[b]=a.global_dicts[b].split(",");this._local_dicts[b]=a.local_dicts[b].split(",");this._temp_dicts[b]=
a.temp_dicts[b].split(",");this._morphemes_from[b]=a.morph_from[b];this._morphemes_to[b]=a.morph_to[b];this._dict_flags[b]=a.dict_flags[b]}this._preData=a;b=this._createViewPanel(a);a=this._createEditPanel(a);this._selfPanel.innerHTML="";this._selfPanel.appendChild(b);this._selfPanel.appendChild(a);this.updateEditElement()},_onDictionaryButtonClicked:function(a){popupDictionaryPanel=new DictionaryPanel;a=Event.findElement(a,"a");a=a.id.substr(a.id.length-1,1);var b={lang1:"",langname1:"",lang2:"",
langname2:""};b.lang1=$(this._selectBoxElements["lang"+String(Number(a)+1)]).value;b.langname1=this.getdataArrayValue(this._langridServiceInformations._sourceLanguageArray,b.lang1);b.lang2=$(this._selectBoxElements["lang"+String(Number(a)+2)]).value;b.langname2=this.getdataArrayValue(this._langridServiceInformations._sourceLanguageArray,b.lang2);popupDictionaryPanel.setParams(a,this.elementsIds.panel,this._langridServiceInformations._dictionaryServicesArray,this._langridServiceInformations._analyzerServicesArray,
b,this._global_dicts[a],this._local_dicts[a],this._temp_dicts[a],this._morphemes_from[a],this._morphemes_to[a],this._default_Settings,this);popupDictionaryPanel.showPane("edit")},_onDictionaryViewClicked:function(a){Event.stop(a);popupDictionaryPanel=new DictionaryPanel;a=Event.findElement(a,"div");a=a.id.substr(a.id.length-1,1);var b={lang1:"",langname1:"",lang2:"",langname2:""};b.lang1=this._preData["lang"+String(Number(a)+1)];b.langname1=this.getdataArrayValue(this._langridServiceInformations._sourceLanguageArray,
b.lang1);b.lang2=this._preData["lang"+String(Number(a)+2)];b.langname2=this.getdataArrayValue(this._langridServiceInformations._sourceLanguageArray,b.lang2);popupDictionaryPanel.setParams(a,this.elementsIds.panel,this._langridServiceInformations._dictionaryServicesArray,this._langridServiceInformations._analyzerServicesArray,b,this._global_dicts[a],this._local_dicts[a],this._temp_dicts[a],this._morphemes_from[a],this._morphemes_to[a],this._default_Settings,this);popupDictionaryPanel.showPane("view")},
_onEditButtonClicked:function(){var a=false;$A(this._PathArray).each(function(c){if(Element.hasClassName(c._selfPanel,"nowedit"))if(!c._onCancelButtonClicked()){a=true;throw $break;}});if(!a){$(this.elementsIds.view).hide();for(var b=0;b<=2;b++){var d=this._dict_flags[b]==2?"icn_custom_dicttionary.gif":"icn_default_dictionary.gif";$(this.elementsIds.panel+":dictimg_"+b)&&$(this.elementsIds.panel+":dictimg_"+b).setAttribute("src","./images/icon/"+d)}$(this.elementsIds.edit).show();Element.addClassName($(this._selfPanel),
"nowedit");document.fire("dom:settingEditingThis");document.fire("dom:refreshMessage")}},_onCancelButtonClicked:function(){if(!Element.hasClassName($(this.elementsIds.panel+":save"),"btn-disable"))if(!confirm(Const.Message.CancelConfirm))return false;$$(".nowedit").each(function(a){$(a.id+":edit")&&$(a.id+":edit").hide();$(a.id+":view")&&$(a.id+":view").show();Element.removeClassName(a,"nowedit")});if(this._PanelMode!="new")this._resetEditPanel();else{$A(this._PathArray).each(function(a,b){a.IndexNumber==
this.IndexNumber&&this._PathArray.splice(b,1)}.bind(this));this._addPanel.innerHTML="";$("new-path-area").hide();$("div-add-path-area").show()}return true},_resetEditPanel:function(){var a=this._selfPanel.lastChild;this._selfPanel.replaceChild(this._createEditPanel(this._preData),a);this.updateEditElement()},setCurrentDictionaryArray:function(){},onDictionaryClickHandler:function(a,b,d,c){switch(c){case "GLOBAL":if(d==true)this._global_dicts[a].push(b);else{b=this._global_dicts[a].indexOf(b);b>-1&&
this._global_dicts[a].splice(b,1)}this._global_dicts[a]=this._global_dicts[a].sort();break;case "LOCAL":if(d==true)this._local_dicts[a].push(b);else{b=this._local_dicts[a].indexOf(b);b>-1&&this._local_dicts[a].splice(b,1)}this._local_dicts[a]=this._local_dicts[a].sort();break;case "USER":if(d==true)this._temp_dicts[a].push(b);else{b=this._temp_dicts[a].indexOf(b);b>-1&&this._temp_dicts[a].splice(b,1)}this._temp_dicts[a]=this._temp_dicts[a].sort();break;case "M_SRC":if(d==true)this._morphemes_from[a]=
b;break;case "M_TGT":if(d==true)this._morphemes_to[a]=b;break}},updateDictionaryFlag:function(a,b){this._global_dicts[a]=this._global_dicts[a].sort();this._local_dicts[a]=this._local_dicts[a].sort();this._temp_dicts[a]=this._temp_dicts[a].sort();this._default_Settings.global=this._default_Settings.global.sort();this._default_Settings.local=this._default_Settings.local.sort();this._default_Settings.temp=this._default_Settings.temp.sort();var d=this._global_dicts[a].join(","),c=this._local_dicts[a].join(","),
e=this._temp_dicts[a].join(","),g=this._default_Settings.global.join(","),h=this._default_Settings.local.join(","),f=this._default_Settings.temp.join(",");this._dict_flags[a]=g==""&&h==""&&f==""?d==""&&c==""&&e==""?0:2:b;b=this._dict_flags[a]==2?"icn_custom_dicttionary.gif":"icn_default_dictionary.gif";$(this.elementsIds.panel+":dictimg_"+a)&&$(this.elementsIds.panel+":dictimg_"+a).setAttribute("src","./images/icon/"+b)},updateMorphologicalAnalyzer:function(a){a=Number(a);switch(a){case 0:this._morphemes_from[a+
1]=this._morphemes_to[a];break;case 1:this._morphemes_to[a-1]=this._morphemes_from[a];this._morphemes_from[a+1]=this._morphemes_to[a];break;case 2:this._morphemes_to[a-1]=this._morphemes_from[a];break}},clearSelectDictionary:function(a){this._global_dicts[a].clear();this._local_dicts[a].clear();this._temp_dicts[a].clear()},makeTdObj:function(a,b){var d=document.createElement("td");if(a!="")d.innerHTML=a;b&&d.appendChild(b);return d},makeDivObj:function(a,b){var d=document.createElement("div");b=b.split(",");
d.className=b[0];if(b.length>1)for(i=1;i<b.length;i++)Element.addClassName(d,b[i]);d.innerHTML=a;return d},makeServiceViewObj:function(a,b){var d=document.createElement("div");Element.addClassName(d,"service-cell");var c=document.createElement("span");Element.setStyle(c,{"float":"left"});c.innerHTML=a;a=document.createElement("span");Element.setStyle(a,{"float":"right"});a.appendChild(b);b=document.createElement("br");Element.setStyle(b,{clear:"both"});d.appendChild(c);d.appendChild(a);d.appendChild(b);
return d},getSetting:function(){try{return $H(this._buildeData()).toQueryString()}catch(a){alert("langrid-bbs-setting.js#getSetting() on Error("+a.number+"):"+a.description)}},validate:function(){var a=this._buildeData();if(a.isDelete=="yes")return null;if((a.lang1&&a.lang2&&a.service1)==false)return Const.Message.SaveOnError1;if(this._checkBoxElements.checkbox1.checked==true)if((a.lang2&&a.lang3&&a.service2)==false)return Const.Message.SaveOnError1;if(this._checkBoxElements.checkbox2.checked==true)if((a.lang3&&
a.lang4&&a.service3)==false)return Const.Message.SaveOnError1;if(a.service3!=""){if(a.lang1==a.lang4)return Const.Message.SaveOnError1}else if(a.service2!=""){if(a.lang1==a.lang3)return Const.Message.SaveOnError1}else if(a.lang1==a.lang2)return Const.Message.SaveOnError1;return null},getLanguagePair:function(){var a=[],b=this._buildeData();if(b.isDelete=="yes")return a;var d=b.lang1,c="";c=this._checkBoxElements.checkbox2.checked==true?b.lang4:this._checkBoxElements.checkbox1.checked==true?b.lang3:
b.lang2;a.push(d+"2"+c);b.flow=="both"&&a.push(c+"2"+d);return a},_buildeData:function(){var a={id:this._primaryId,isDelete:this._isDelete,lang1:$(this._selectBoxElements.lang1).value,lang2:$(this._selectBoxElements.lang2).value,lang3:$(this._selectBoxElements.lang3).value,lang4:$(this._selectBoxElements.lang4).value,flow:$(this._selectBoxElements.flow1).value,flow1:$(this._selectBoxElements.flow1).value,flow2:$(this._selectBoxElements.flow2).value,flow3:$(this._selectBoxElements.flow3).value,service1:this._servicePanelElements[0].getSetting(),
service2:this._servicePanelElements[1].getSetting(),service3:this._servicePanelElements[2].getSetting(),global_dict_1:this._global_dicts[0].join(","),global_dict_2:this._global_dicts[1].join(","),global_dict_3:this._global_dicts[2].join(","),local_dict_1:this._local_dicts[0].join(","),local_dict_2:this._local_dicts[1].join(","),local_dict_3:this._local_dicts[2].join(","),temp_dict_1:this._temp_dicts[0].join(","),temp_dict_2:this._temp_dicts[1].join(","),temp_dict_3:this._temp_dicts[2].join(","),dict_flag_1:this._dict_flags[0],
dict_flag_2:this._dict_flags[1],dict_flag_3:this._dict_flags[2],morph_analyzer1:this._morphemes_from[0],morph_analyzer2:this._morphemes_from[1],morph_analyzer3:this._morphemes_from[2],morph_analyzer4:this._morphemes_to[2],panelId:$(this._selfPanel).id};if(!this.isSupportedAnalyzer(a.morph_analyzer1,a.lang1))a.morph_analyzer1=getDefaultMorphologicalAnalyzer(a.lang1);if(!this.isSupportedAnalyzer(a.morph_analyzer2,a.lang2))a.morph_analyzer2=getDefaultMorphologicalAnalyzer(a.lang2);if(!this.isSupportedAnalyzer(a.morph_analyzer3,
a.lang3))a.morph_analyzer3=getDefaultMorphologicalAnalyzer(a.lang3);if(!this.isSupportedAnalyzer(a.morph_analyzer4,a.lang4))a.morph_analyzer4=getDefaultMorphologicalAnalyzer(a.lang4);return a},_checkChange:function(){var a=this._preData;if(a.lang1!=$(this._selectBoxElements.lang1).value)return true;if(a.lang2!=$(this._selectBoxElements.lang2).value)return true;if(a.lang3!=$(this._selectBoxElements.lang3).value)return true;if(a.lang4!=$(this._selectBoxElements.lang4).value)return true;if(a.flow!=$(this._selectBoxElements.flow1).value)return true;
if(a.service1!=this._servicePanelElements[0].getSetting())return true;if(a.service2!=this._servicePanelElements[1].getSetting())return true;if(a.service3!=this._servicePanelElements[2].getSetting())return true;$(this._selectBoxElements.lang4).value==""&&$(this._selectBoxElements.lang3);for(var b=0;b<=2;b++){if(a.dict_flags[b]!=this._dict_flags[b])return true;var d=a.global_dicts[b].split(",").sort(),c=this._global_dicts[b].sort();if(d.join(",")!=c.join(","))return true;d=a.local_dicts[b].split(",").sort();
c=this._local_dicts[b].sort();if(d.join(",")!=c.join(","))return true;d=a.temp_dicts[b].split(",").sort();c=this._temp_dicts[b].sort();if(d.join(",")!=c.join(","))return true;if(a.morph_from[b]!=this._morphemes_from[b])return true;if(a.morph_to[b]!=this._morphemes_to[b])return true}return false},updatePrimaryId:function(a){this._primaryId=a},getViewData:function(){return this.viewData},isSupportedAnalyzer:function(a,b){var d=false;this._langridServiceInformations._analyzerServicesArray.each(function(c){if(c.service_id==
a){var e=[];e=c.supported_languages_paths.split(",");if(c.service_type=="ANALYZER"&&e.indexOf(b)>-1){d=true;throw $break;}}});return d},_getValidAnalyzer:function(a,b){return this.isSupportedAnalyzer(a,b)?a:getDefaultMorphologicalAnalyzer(b)},_sortPanelArray:function(){if(this._PathArray.length){this.__sort_array(this._PathArray,0,this._PathArray.length-1);for(var a=0;a<this._PathArray.length;a++)$("list-area").appendChild(this._PathArray[a]._selfPanel)}},__sort_array:function(a,b,d){for(var c=a[parseInt(b+
(d-b)/2)],e=b-1,g=d+1;1;){for(;this.__cmp_data(a[++e],c)<0;);for(;this.__cmp_data(a[--g],c)>0;);if(e>=g)break;var h=a[e];a[e]=a[g];a[g]=h}b<e-1&&this.__sort_array(a,b,e-1);g+1<d&&this.__sort_array(a,g+1,d);return a},__cmp_data:function(a,b){var d=a.getdataArrayValue(a._langridServiceInformations._sourceLanguageArray,a.FirstLang);a=a.getdataArrayValue(a._langridServiceInformations._targetLanguageArray,a.LastLang);var c=b.getdataArrayValue(b._langridServiceInformations._sourceLanguageArray,b.FirstLang);
b=b.getdataArrayValue(b._langridServiceInformations._targetLanguageArray,b.LastLang);return d==c?a==b?0:a>b?1:-1:d>c?1:-1},_copyArrayValue:function(a){var b=[];if(a instanceof Array)for(var d=0;d<a.length;d++)b[d]=a[d]instanceof Array?this._copyArrayValue(a[d]):a[d];return b},_explode:function(a,b){return a!=null?a.split(b):[]},__util:function(a){a=a.split("2");return this._langridServiceInformations._sourceLanguageArray[a[0]]+"--\>"+this._langridServiceInformations._sourceLanguageArray[a[1]]}};
var BBSPathPanel=Class.create();Object.extend(BBSPathPanel.prototype,TranslationPathPanel.prototype);
Object.extend(BBSPathPanel.prototype,{_saveSetting:function(a){var b=this,d={};d.mode="BBS";$A(a).each(function(c,e){d["data["+e+"]"]=c});a=$H(d).toQueryString();new Ajax.Request("./ajax/save-bbs-setting.php",{method:"post",parameters:a,asynchronous:false,controller:b,onSuccess:function(c){c=c.responseText.evalJSON();if(c.status=="SESSIONTIMEOUT")redirect2top();else{this.errorView(false);var e=this._buildeData(),g=this.getdataArrayValue(this._langridServiceInformations._sourceLanguageArray,e.lang1),
h=this.getdataArrayValue(this._CONST_FLOW_OPS,e.flow);e=e.lang4!=""?this.getdataArrayValue(this._langridServiceInformations._sourceLanguageArray,e.lang4):e.lang3!=""?this.getdataArrayValue(this._langridServiceInformations._sourceLanguageArray,e.lang3):this.getdataArrayValue(this._langridServiceInformations._sourceLanguageArray,e.lang2);var f=this._PanelMode=="new"?Const.Message.AddedMessage:Const.Message.SavedMessage;f=f.replace("%SRC",g);f=f.replace("%FLW",h);f=f.replace("%TGT",e);this.updatePrimaryId(c.contents[this.elementsIds.panel]);
if(this._PanelMode=="new"){$("top-message-area").innerHTML=f;$("top-message-area").show();e=this._buildeData();c=this._PathArray.length;g=new BBSPathPanel;g.makeTranslationPathPanel_A(c,this._rootPanel,this._langridServiceInformations,this._PathArray,this._default_Settings,e);this._PathArray.push(g);for(c=0;c<this._PathArray.length;c++)if(this._PathArray[c]==this){this._PathArray.splice(c,1);break}this._sortPanelArray()}else if(this._isDelete=="yes")for(c=0;c<this._PathArray.length;c++){if(this._PathArray[c]==
this){this._PathArray.splice(c,1);break}}else{this.updateViewPanel();this.showMessageBox(f)}}}.bind(this),onFailure:function(c){$("error_message").innerHTML="<per>"+c.responseText+"</pre>"},onComplete:function(){$$(".nowedit").each(function(c){$(c.id+":edit")&&$(c.id+":edit").hide();$(c.id+":view")&&$(c.id+":view").show();Element.removeClassName(c,"nowedit");var e=$(c.id+":save");Element.removeClassName(e,"btn");Element.addClassName(e,"btn-disable");$(c.id+":save-img").setAttribute("src",Const.Images.SaveOff)});
if(this._PanelMode=="new"){this._addPanel.innerHTML="";this._addPanel.hide();$("div-add-path-area").show()}bBSAddPathWorkspace._resetFilter()}.bind(this)})}});var ServicePanel=Class.create();
ServicePanel.prototype={_langridServiceInformations:null,_interElement:null,_thisPanel:null,_this_id:null,_serviceButtonArray:null,_currentSelectServiceId:null,_currentSelectSourceLang:null,_currentSelectTargetLang:null,_currentSelectFlow:null,_afterInsertTargetElement:null,_sourceSelect:null,_targetSelect:null,_flowSelect:null,disabled:false,_targetLanguageArray:null,initialize:function(a){this._targetLanguageArray=a},makeServicePanel:function(a,b,d,c,e,g,h){this._interElement=a;this._langridServiceInformations=
d;this._this_id=b+":services-"+c;this._serviceButtonArray={};this._currentSelectServiceId="";this._sourceSelect=e;this._targetSelect=g;this._flowSelect=h;this._initEvent()},_initEvent:function(){this._interElement.innerHTML+="Translator";var a=document.createElement("div");a.id=this._this_id;var b=this;this._langridServiceInformations.each(function(d){var c=new ServiceButton;c.makeServiceButton(a,d,b._onServiceButtonSelectHandler,b);b._serviceButtonArray[d.service_id]=c});this._interElement.appendChild(a)},
_onSelectService:function(a){this.setActiveServiceId(a.memo.service_id)},_onServiceButtonSelectHandler:function(a){if(!this.disabled){a=$(Event.element(a).up()).id.split(":");this.setActiveServiceId(a[a.length-1])}},setLanguageSelectors:function(a,b,d){this._currentSelectSourceLang=$(a).value;this._currentSelectTargetLang=$(b).value;this._currentSelectFlow=$(d).value;var c=this;a.observe("change",function(e){e=$(Event.element(e)).value;c._currentSelectSourceLang=e;c._updateService()}.bind(c),false);
b.observe("change",function(e){e=$(Event.element(e)).value;c._currentSelectTargetLang=e;c._updateService()}.bind(c),false);d!=null&&d.observe("change",function(e){e=$(Event.element(e)).value;c._currentSelectFlow=e;c._updateService()}.bind(c),false);this._afterInsertTargetElement=b},_updateService:function(){this._crearAllSelect(this._targetSelect);var a=this._currentSelectServiceId,b=[],d=this;$H(this._serviceButtonArray).each(function(g){b.push($(g.value)._getMatchLangTgt(d._currentSelectSourceLang,
d._currentSelectFlow));if(g.key==a)if($(g.value).isSupportedLanguage(d._currentSelectSourceLang,d._currentSelectTargetLang,d._currentSelectFlow))$(g.value).setButtonMode("active");else{$(g.value).setButtonMode("hide");d._currentSelectServiceId=""}else $(g.value).isSupportedLanguage(d._currentSelectSourceLang,d._currentSelectTargetLang,d._currentSelectFlow)?$(g.value).setButtonMode("display"):$(g.value).setButtonMode("hide")}.bind(d));b=b.flatten();var c=[];if(b.length)for(i=0;i<b.length;i++){var e=
this.getdataArrayValue(this._targetLanguageArray,b[i])+"\n"+String(b[i]);for(j=0;j<c.length;j++)if(c[j]==e){e="";break}e!=""&&c.push(e)}c=c.sort();this._makeTargetSelect(c);document.fire("dom:settingEditingThis")},_crearAllSelect:function(a){if(a.hasChildNodes())for(var b=a.lastChild;b;){var d=b;b=b.previousSibling;a.removeChild(d)}},_makeTargetSelect:function(a){if(this._targetSelect){var b=this._targetSelect,d=document.createElement("option");d.setAttribute("value","");d.innerHTML="---";b.appendChild(d);
for(i=0;i<a.length;i++){d=a[i].split("\n");if(d[0]!=""){var c=document.createElement("option");c.setAttribute("value",d[1]);c.innerHTML=d[0];d[1]==this._currentSelectTargetLang&&c.setAttribute("selected","yes");b.appendChild(c)}}}},getdataArrayValue:function(a,b){var d="";a=$H(a);if(b!=""&&a)if(a.get(b))d=a.get(b);return d},setActiveServiceId:function(a){this._currentSelectServiceId=a==null||a==""||this._serviceButtonArray[a]=="undefined"?"":a;this._updateService()},clearSelection:function(){this._currentSelectServiceId=
"";this._currentSelectFlow="left";this._currentSelectTargetLang="";this._updateService()},makeAndBindTranslationCombinationCheckbox:function(a,b){var d=document.createElement("input");d.id=this._this_id+":combination";d.setAttribute("type","checkbox");d.setAttribute("value","on");Event.observe(d,"click",b.bindAsEventListener(a,d));return d},getSetting:function(){return this._currentSelectServiceId}};var ServiceButton=Class.create();
ServiceButton.prototype={__CSS_ON:"setting_btn_on",__CSS_OFF:"setting_btn_off",_serviceInfo:null,_parentElem:null,_this_id:null,_buttonElem:null,_buttonArea:null,initialize:function(){},makeServiceButton:function(a,b,d,c){this._parentElem=a;this._serviceInfo=b;this._this_id=a.id+":"+this._serviceInfo.service_id;this._buttonArea=document.createElement("div");this._buttonArea.id=a.id+":btArea:"+this._serviceInfo.service_id;this._buttonElem=this._showButton(this._buttonArea);this._buttonElem.observe("click",
d.bindAsEventListener(c));return this._buttonElem},setButtonMode:function(a){if(a=="active"){Element.removeClassName(this._buttonElem,this.__CSS_OFF);Element.addClassName(this._buttonElem,this.__CSS_ON);Element.show(this._buttonElem)}else if(a=="display"){Element.removeClassName(this._buttonElem,this.__CSS_ON);Element.addClassName(this._buttonElem,this.__CSS_OFF);Element.show(this._buttonArea)}else if(a=="hide"){Element.removeClassName(this._buttonElem,this.__CSS_ON);Element.addClassName(this._buttonElem,
this.__CSS_OFF);Element.hide(this._buttonArea)}},isSupportedLanguage:function(a,b,d){var c=this._getSupportedLanguage(),e=false;if(d=="both"){d=a+"2"+b;a=b+"2"+a;if(c.indexOf(d)>-1&&c.indexOf(a)>-1)e=true}else if(d=="left"){d=a+"2"+b;if(c.indexOf(d)>-1)e=true}else e=false;return e},isSupportedLanguageExt:function(a,b,d){var c=false;if(a!=""&&b!=""){var e=this._getSupportedLanguage();if(d=="both"){d=a+"2"+b;a=b+"2"+a;if(e.indexOf(d)>-1&&e.indexOf(a)>-1)c=true}else if(d=="left"){d=a+"2"+b;if(e.indexOf(d)>
-1)c=true}else c=false}else if(a!=""||b!=""){e=","+this._serviceInfo.supported_languages_paths+",";if(a!="")var g=","+a+"2";if(b!="")g="2"+b+",";if(e.indexOf(g)>-1)c=true;if(d=="both"){if(a!="")var h="2"+a+",";if(b!="")h=","+b+"2";if(e.indexOf(h)>-1)c=true}}else c=false;return c},_getMatchLangTgt:function(a,b){var d=Array(),c=new RegExp("^"+a+"2.+$"),e=new RegExp("^.+2"+a+"$"),g=this._getSupportedLanguage();for(i=0;i<g.length;i++)if(g[i].match(c)){var h=g[i].split("2");h[1]!=a&&d.push(h[1])}else if(b==
"both")if(g[i].match(e)){h=g[i].split("2");h[1]!=a&&d.push(h[1])}return d},_getSupportedLanguage:function(){return this._serviceInfo.supported_languages_paths.split(",")},_showButton:function(a){var b=document.createElement("a");b.id=this._this_id;Element.addClassName(b,this.__CSS_OFF);b.innerHTML=this._serviceInfo.service_name;a.appendChild(b);var d=document.createElement("a");Element.addClassName(d,"btn-service-info");d.innerHTML="[i]";d.observe("click",this._showPopup.bindAsEventListener(this));
a.appendChild(d);d=document.createElement("br");Element.addClassName(d,"clear");a.appendChild(d);this._parentElem.appendChild(a);return b},_showPopup:function(a){Event.stop(a);var b=Event.element(a).cumulativeOffset();a=b[1];b=b[0]+20;var d=$("baloon-"+this._serviceInfo.service_id);if(d.style.display=="none"){$$(".popnowopen").each(function(g){Element.removeClassName(g,"popnowopen");Element.hide(g)});Element.addClassName(d,"popnowopen");Element.show(d);var c=document.viewport.getDimensions(),e=document.viewport.getScrollOffsets();
if(a+d.offsetHeight-e.top>c.height)a=c.height-d.offsetHeight+e.top;if(b+d.offsetWidth-e.left>c.width)b=b-30>d.offsetWidth?b-30-d.offsetWidth:c.width-d.offsetWidth+e.left;d.setStyle("position:absolute; left:"+b+"px; top:"+a+"px")}else{Element.removeClassName(d,"popnowopen");Element.hide(d)}},_hidePopup:function(a){Event.stop(a);$("baloon-"+this._serviceInfo.service_id).hide()}};var AbstractSingletonPane=Class.create();
AbstractSingletonPane.prototype={initialize:function(a){$("singleton-pane")&&$("singleton-pane").remove();$("mask-pane")&&$("mask-pane").remove();this.paneID="singleton-pane";this.maskID="mask-pane";var b='<div class="input-box" id="'+this.paneID+'" style="z-index:10;"></div>';b+='<div id="'+this.maskID+'" style="z-index:5;" class="pop-mask"></div>';this.table=a;try{new Insertion.Bottom($$("body")[0],b);this.hidePane()}catch(d){}},showPane:function(a,b){if(this.notShowPane())return false;$(this.paneID).setStyle({position:"absolute",
left:a+"px",top:b+"px"});$(this.paneID).innerHTML=this.getPane();$(this.paneID).show();this.onShowPane()},setStatus:function(a,b){b=b||0;$("singleton-pane-status-"+b).innerHTML=a},notShowPane:function(){return false},onShowPane:function(){},getPane:function(){},submit:function(){},hidePane:function(){$(this.paneID).hide();$(this.maskID).hide()}};var DictionaryPanel=Class.create(),popupDictionaryPanel=null;
DictionaryPanel.prototype=Object.extend(new AbstractSingletonPane,{_level:null,_fix:null,_DictInfoArray:null,_AnalyzerInfoArray:null,_langs:null,_cur_global_dics:null,_cur_local_dics:null,_cur_temp_dics:null,_cur_morph_from:null,_cur_morph_to:null,_defaultSettings:null,_controller:null,_mode:null,_DictFlag:null,showPane:function(a){this._mode=a;if(this.notShowPane())return false;a=document.viewport.getDimensions();var b=document.viewport.getScrollOffsets(),d=$(this.maskID);d.style.filter="alpha(opacity=40)";
d.style.MozOpacity=0.4;d.style.opacity=0.4;d.show();d.setStyle({position:"absolute",top:b.top+"px",left:b.left+"px",width:a.width+"px",height:a.height+"px"});Event.observe(window,"scroll",this._onScrollWin.bind(this),false);Event.observe(window,"resize",this._onResizeWin.bind(this),false);Element.update(this.paneID,this.getPane());$(this.paneID).show();d=(a.width-$("popwin").offsetWidth)/2+b.left;var c=(a.height-$("popwin").offsetHeight)/2+b.top;if(c+$("popwin").offsetHeight-b.top>a.height)c=a.height-
$("popwin").offsetHeight+b.top;if(d+$("popwin").offsetWidth-b.left>a.width)d=a.width-$("popwin").offsetWidth+b.left;$(this.paneID).setStyle({position:"absolute",left:d+"px",top:c+"px"});this.onShowPane()},hidePane:function(){Event.stopObserving(window,"scroll",this._onScrollWin.bind(this),false);Event.stopObserving(window,"resize",this._onResizeWin.bind(this),false);$(this.paneID).hide();$(this.maskID).hide()},_onScrollWin:function(){var a=document.viewport.getScrollOffsets();$(this.maskID).setStyle({top:a.top+
"px",left:a.left+"px"})},_onResizeWin:function(){var a=document.viewport.getDimensions();$(this.maskID).setStyle({width:a.width+"px",height:a.height+"px"})},setParams:function(a,b,d,c,e,g,h,f,l,k,o,p){this._level=a;this._fix=b;this._DictInfoArray=d;this._AnalyzerInfoArray=c;this._langs=e;this._cur_global_dics=g;this._cur_local_dics=h;this._cur_temp_dics=f;this._cur_morph_from=l;this._cur_morph_to=k;this._defaultSettings=o;this._controller=p;if(b!="default"){this._DictFlag=p._dict_flags[a];if(!p.isSupportedAnalyzer(this._cur_morph_from,
e.lang1))this._cur_morph_from=getDefaultMorphologicalAnalyzer(e.lang1);if(!p.isSupportedAnalyzer(this._cur_morph_to,e.lang2))this._cur_morph_to=getDefaultMorphologicalAnalyzer(e.lang2)}},getPane:function(){var a=[],b=[],d=[];a.push('<div class="dic-subwindow-border" id="popwin">');a.push('<div class="dictionary-body">');a.push('<div class="tab_on" id="dic_title" onclick="popupDictionaryPanel.onChangeTab(0);">');a.push(Const.Popup.Title);this._fix=="default"&&a.push("("+Const.Label.Default+")");a.push("</div>");
if(this._fix!="default"){a.push('<div class="tab_off" id="morph_title" onclick="popupDictionaryPanel.onChangeTab(1);">');a.push(Const.Popup.MA_Title+"</div>")}a.push('<div class="main_contents" id="dict_body">');a.push("<h2>"+Const.Popup.Label1+"</h2>");var c=this,e=0;this._DictInfoArray.each(function(f){if(f.service_type=="DICTIONARY"){var l=c._fix+":"+f.service_id,k="";k+='<div class="clearfix">';k+='<label for="'+l+':GLOBAL">';if(this._mode!="view"){k+='<input type="checkbox" id="'+l+':GLOBAL" value="'+
l+'"';k+=' onclick="popupDictionaryPanel.onChangeVal(this);"';if(c._cur_global_dics.indexOf(f.service_id)>-1){k+=' checked="yes" ';b.push(f.service_id)}k+="/>";k+='<span style="margin-left:2px;">'+f.service_name+"</span>"}else if(c._cur_global_dics.indexOf(f.service_id)>-1){k+='<input type="checkbox" checked="yes" disabled="true" />';k+='<span style="margin-left:2px;">'+f.service_name+"</span>";e++}k+="</label></div>";a.push(k)}}.bind(this));this._mode=="view"&&e==0&&a.push(Const.Message.NoSelectedDict);
a.push("<h2>"+Const.Popup.Label3+"</h2>");c=this;var g=0;e=0;this._DictInfoArray.each(function(f){if(f.service_type=="IMPORTED_DICTIONARY"){var l=c._fix+":"+f.service_id,k="";g++;k+='<div class="clearfix">';k+='<label for="'+l+':LOCAL">';if(this._mode!="view"){k+='<input type="checkbox" id="'+l+':LOCAL" value="'+l+'"';k+=' onclick="popupDictionaryPanel.onChangeVal(this);"';if(c._cur_local_dics.indexOf(f.service_id)>-1){k+=' checked="yes" ';b.push(f.service_id)}k+="/>";k+='<span style="margin-left:2px;">'+
f.service_name+"</span>"}else if(c._cur_local_dics.indexOf(f.service_id)>-1){k+='<input type="checkbox" checked="yes" disabled="true" />';k+='<span style="margin-left:2px;">'+f.service_name+"</span>";e++}k+="</label></div>";a.push(k)}}.bind(this));if(this._mode=="view"&&e==0)a.push(Const.Message.NoSelectedLocalDict);else g==0&&a.push(Const.Message.NoDictionaryLocal);a.push("<h2>"+Const.Popup.Label2+"</h2>");var h=g=0;this._DictInfoArray.each(function(f){if(f.service_type=="USER_DICTIONARY"){var l=
c._fix+":"+f.service_id,k="";g++;k+='<div class="clearfix">';k+='<label for="'+l+':USER">';if(this._mode!="view"){k+='<input type="checkbox" id="'+l+':USER" value="'+l+'"';k+=' onclick="popupDictionaryPanel.onChangeVal(this);"';if(c._cur_temp_dics.indexOf(f.service_id)>-1){k+=' checked="yes" ';d.push(f.service_id)}k+="/>";k+='<span style="margin-left:2px;">'+f.service_name+"</span>"}else if(c._cur_temp_dics.indexOf(f.service_id)>-1){k+='<input type="checkbox" checked="yes" disabled="true" />';k+=
'<span style="margin-left:2px;">'+f.service_name+"</span>";h++}k+="</label></div>";a.push(k)}}.bind(this));if(this._mode=="view"&&h==0)a.push(Const.Message.NoSelectedUserDict);else g==0&&a.push(Const.Message.NoDictionaryTemporal);a.push("</div>");if(this._fix!="default"){a.push('<div class="main_contents" id="morph_body" style="display:none;">');a.push("<h2>"+this._langs.langname1+"</h2>");c=this;e=0;this._AnalyzerInfoArray.each(function(f){var l=[];l=f.supported_languages_paths.split(",");if(f.service_type==
"ANALYZER"&&l.indexOf(c._langs.lang1)>-1){l=c._fix+":"+f.service_id;var k="";k+='<div class="clearfix">';k+='<label for="'+l+':M_SRC">';if(this._mode!="view"){k+='<input type="radio" id="'+l+':M_SRC" value="'+l+'" name="M_SRC"';if(c._cur_morph_from==f.service_id)k+=' checked="yes" ';k+="/>";k+='<span style="margin-left:2px;">'+f.service_name+"</span>";e++}else if(c._cur_morph_from==f.service_id){k+='<input type="radio" checked="yes" disabled="true" />';k+='<span style="margin-left:2px;">'+f.service_name+
"</span>";e++}k+="</label></div>";a.push(k)}}.bind(this));e==0&&a.push("--");a.push("<h2>"+this._langs.langname2+"</h2>");c=this;e=0;this._AnalyzerInfoArray.each(function(f){var l=[];l=f.supported_languages_paths.split(",");if(f.service_type=="ANALYZER"&&l.indexOf(c._langs.lang2)>-1){l=c._fix+":"+f.service_id;var k="";k+='<div class="clearfix">';k+='<label for="'+l+':M_TGT">';if(this._mode!="view"){k+='<input type="radio" id="'+l+':M_TGT" value="'+l+'" name="M_TGT"';if(c._cur_morph_to==f.service_id)k+=
' checked="yes" ';k+="/>";k+='<span style="margin-left:2px;">'+f.service_name+"</span>";e++}else if(c._cur_morph_to==f.service_id){k+='<input type="radio" checked="yes" disabled="true" />';k+='<span style="margin-left:2px;">'+f.service_name+"</span>";e++}k+="</label></div>";a.push(k)}}.bind(this));e==0&&a.push("--")}a.push("</div>");a.push('<div style="margin-top: 8px;">');if(this._mode=="view"){a.push('<a class="btn" style="width: 140px; margin-left: 330px;" onclick="popupDictionaryPanel.hidePane();">');
a.push('<img src="'+Const.Images.Close+'" />'+Const.Label.CloseBtn+"</a> ")}else{a.push('<div style="float:left;">');if(this._fix!="default"){a.push(' <a class="btn" style="width: 140px;" onclick="popupDictionaryPanel.onLoadDefault();" id="DEFAULT_BTN">');a.push(Const.Popup.LoadDefault+"</a>")}a.push(" </div>");a.push('<div style="float:right; margin-right:8px;"> ');a.push('<a class="btn" onclick="popupDictionaryPanel.hidePane();">');a.push('<img src="'+Const.Images.Cancel+'" />'+Const.Popup.BTN_CANCEL+
"</a> ");a.push('<a class="btn" onclick="popupDictionaryPanel._onSubmit();">');a.push('<img src="'+Const.Images.SaveOn+'" />'+Const.Label.Save+"</a></div>");a.push("</div>")}a.push('<br class="clear" />');a.push("</div>");a.push("</div>");return a.join("")},_onSubmit:function(){this._controller.clearSelectDictionary(this._level);var a=this._controller,b=0,d=0;$$("#singleton-pane input").each(function(c){var e=c.id,g=e.split(":");if(g.length!=3)alert("Error:Element-ID="+e);else{a.onDictionaryClickHandler(this._level,
g[1],c.checked,g[2]);g[2]=="M_SRC"&&c.checked&&b++;g[2]=="M_TGT"&&c.checked&&d++}}.bind(this));if(this._fix=="default")a.onDictionarySaveHandler();else{if(b==0)a._morphemes_from[this._level]="";if(d==0)a._morphemes_to[this._level]="";a.updateDictionaryFlag(this._level,this._DictFlag);a.updateMorphologicalAnalyzer(this._level);document.fire("dom:settingEditingThis")}this.hidePane()},onLoadDefault:function(){$$("#singleton-pane input").each(function(a){var b=a.id.split(":");if(b.length!=3)a.checked=
false;else switch(b[2]){case "GLOBAL":a.checked=this._defaultSettings.global.indexOf(b[1])>-1?true:false;break;case "LOCAL":a.checked=this._defaultSettings.local.indexOf(b[1])>-1?true:false;break;case "USER":a.checked=this._defaultSettings.temp.indexOf(b[1])>-1?true:false;break;case "M_SRC":if(this._defaultSettings.morph_from==b[1])a.checked=true;break;case "M_TGT":if(this._defaultSettings.morph_to==b[1])a.checked=true;break}}.bind(this));this._DictFlag=1},onChangeVal:function(a){var b=0;$$("#singleton-pane input").each(function(d){var c=
d.id.split(":");if(c.length!=3)d.checked=false;else switch(c[2]){case "GLOBAL":d.checked&&b++;break;case "LOCAL":d.checked&&b++;break;case "USER":break}});if(b>Const.DEFINE.MaxDicts){a.checked=false;a=Const.Message.OverMaxDictCount;a=a.replace("%MAX",Const.DEFINE.MaxDicts);alert(a)}else this._DictFlag=2},onChangeTab:function(a){if(a==0){if(Element.hasClassName($("dic_title"),"tab_off")){Element.removeClassName($("dic_title"),"tab_off");Element.addClassName($("dic_title"),"tab_on");$("dict_body").show();
Element.removeClassName($("morph_title"),"tab_on");Element.addClassName($("morph_title"),"tab_off");$("morph_body").hide();$("DEFAULT_BTN")&&$("DEFAULT_BTN").show()}}else if(Element.hasClassName($("morph_title"),"tab_off")){Element.removeClassName($("morph_title"),"tab_off");Element.addClassName($("morph_title"),"tab_on");$("morph_body").show();Element.removeClassName($("dic_title"),"tab_on");Element.addClassName($("dic_title"),"tab_off");$("dict_body").hide();$("DEFAULT_BTN")&&$("DEFAULT_BTN").hide()}},
__dump:function(){alert(this._controller.source())}});WebAddPathWorkspace=Class.create();Object.extend(WebAddPathWorkspace.prototype,AddPathWorkspace.prototype);
Object.extend(WebAddPathWorkspace.prototype,{MainPanel:null,pathPanelArray:Array(),_DefaultSettings:null,initialize:function(){this.MainPanel=$("translation-path-root-panel-web");Event.observe(document,"dom:settingEditingThis",this._onSaveButtonToggle.bind(this));Event.observe(document,"dom:refreshMessage",this._refreshMessage.bind(this));Event.observe(window,"beforeunload",this._confirmChange.bind(this));this._DefaultSettings={global:Array(),local:Array(),temp:Array()}},_showPanel:function(a,b){var d=
"W"+this.pathPanelArray.length,c=new WebPathPanel;c.makeTranslationPathPanel(d,b,this._langridServiceInformations,this.pathPanelArray,this._DefaultSettings,a);this.pathPanelArray.push(c)},__initializingView:function(){$("tab5_nowload").show();var a=this.MainPanel.childNodes.length-1;if(a>0)for(a=a;a>0;a--){var b=this.MainPanel.childNodes[a];b.nodeName!=undefined&&this.MainPanel.removeChild(b)}this.MainPanel.innerHTML="";$("tab5_error_message").innerHTML=""},__initializedView:function(){this._sortPanelArray();
$("tab5_nowload").hide()},__initializedError:function(a){var b=[];b.push('<div style="color:#FF6347;">');b.push("<h2>ERROR:failed in initialization processing.</h2>");b.push("<pre>"+a.description+"</pre>");b.push("</div>");$("tab5_nowload").innerHTML=b.join("")},_loadSetting:function(){var a=this,b=$H({}).toQueryString();new Ajax.Request("./ajax/load-web-setting.php",{method:"post",parameters:b,controller:a,onSuccess:function(d){try{var c=d.responseText.evalJSON();if(c.status!="OK"){if(c.status==
"SESSIONTIMEOUT"){redirect2top();return}alert(c.message);return}a._langridServiceInformations._sourceLanguageArray=c.contents.supportLangs.sourceLanguages;a._langridServiceInformations._targetLanguageArray=c.contents.supportLangs.targetLanguages;a._langridServiceInformations._translationServicesArray=c.contents.translationServices;a._langridServiceInformations._analyzerServicesArray=c.contents.analyzeServices;a._langridServiceInformations._dictionaryServicesArray=c.contents.dictionaryServices;a._langridServiceInformations._currentSettings=
c.contents.setting;var e=c.contents.DefaultDicts.bind_global_dict_ids;if(e!=null&&!e=="")a._DefaultSettings.global=e.split(",");var g=c.contents.DefaultDicts.bind_local_dict_ids;if(g!=null&&!g=="")a._DefaultSettings.local=g.split(",");var h=c.contents.DefaultDicts.bind_user_dict_ids;if(h!=null&&!h=="")a._DefaultSettings.temp=h.split(",");a._makeSearchPanel();a._makeEditSettingArea();$("list-area")&&Element.remove($("list-area"));var f=document.createElement("div");f.id="list-area";$A(a._langridServiceInformations._currentSettings).each(function(k){a._showPanel(k,
f)}.bind(a));a.MainPanel.appendChild(f);a._makePageTopArea();a.__initializedView()}catch(l){a.__initializedError(l)}isInitializing=false}.bind(this),onFailure:function(d){$("tab5_error_message").innerHTML="<pre>"+d.responseText+"</pre>"},onComplete:function(){}})},onDictionarySaveHandler:function(){if(this._DefaultSettings.global.length!=0||this._DefaultSettings.local.length!=0||this._DefaultSettings.temp.length!=0)$A(this.pathPanelArray).each(function(d){if(d.elementsIds.panel!="panel-N"&&d._primaryId==
""){d._makeSaveDataAll();document.fire("dom:refreshMessage");throw $break;}});var a=this,b={};b.mode="WEB";b.global_dict_ids=this._DefaultSettings.global.join(",");b.local_dict_ids=this._DefaultSettings.local.join(",");b.user_dict_ids=this._DefaultSettings.temp.join(",");b=$H(b).toQueryString();new Ajax.Request("./ajax/save-web-dict.php",{method:"post",parameters:b,controller:a,onSuccess:function(d){if(d.responseText.evalJSON().status=="SESSIONTIMEOUT")redirect2top();else isInitializing==false&&$A(a.pathPanelArray).each(function(c){if(a._DefaultSettings.global.length==
0&&a._DefaultSettings.local.length==0&&a._DefaultSettings.temp.length==0)for(var e=0;e<=2;e++){if(c._dict_flags[e]==1){c._dict_flags[e]=0;if($(c.elementsIds.panel+":viewdictimg_"+e)){c._global_dicts[e]=[];c._local_dicts[e]=[];c._temp_dicts[e]=[];c.updateViewPanel();$(c.elementsIds.panel+":viewdictimg_"+e).hide()}}}else for(e=0;e<=2;e++)if(c._dict_flags[e]==0||c._dict_flags[e]==1){c._dict_flags[e]=1;c._global_dicts[e]=a._DefaultSettings.global.join(",").split(",");c._local_dicts[e]=a._DefaultSettings.local.join(",").split(",");
c._temp_dicts[e]=a._DefaultSettings.temp.join(",").split(",");c.updateViewPanel();if($(c.elementsIds.panel+":viewdictimg_"+e)){var g=$(c.elementsIds.panel+":viewdictimg_"+e);Element.removeClassName(g,"btn-user-dic");Element.addClassName(g,"btn-def-dic");g.show()}}}.bind(a))}.bind(this),onFailure:function(d){$("tab5_error_message").innerHTML="<per>"+d.responseText+"</pre>"},onComplete:function(){this._setDictionaryCount()}.bind(this)})},_onAddPathButtonClicked:function(){var a=false;$A(this.pathPanelArray).each(function(d){if(Element.hasClassName(d._selfPanel,
"nowedit"))if(!d._onCancelButtonClicked()){a=true;throw $break;}});if(!a){var b=new WebPathPanel;b.makeNewTranslationPathPanel($("list-area"),$("new-path-area"),this._langridServiceInformations,this.pathPanelArray,this._DefaultSettings);Element.addClassName(b._selfPanel,"nowedit");this.pathPanelArray.push(b);Element.hide($("div-add-path-area"));Element.show($("new-path-area"));document.fire("dom:refreshMessage")}},_langridServiceInformations:{}});var WebPathPanel=Class.create();
Object.extend(WebPathPanel.prototype,TranslationPathPanel.prototype);
Object.extend(WebPathPanel.prototype,{_saveSetting:function(a){var b=this,d={};d.mode="WEB";$A(a).each(function(c,e){d["data["+e+"]"]=c});a=$H(d).toQueryString();new Ajax.Request("./ajax/save-web-setting.php",{method:"post",parameters:a,asynchronous:false,controller:b,onSuccess:function(c){var e=c.responseText.evalJSON();if(e.status=="SESSIONTIMEOUT")redirect2top();else{this.errorView(false);c=this._buildeData();var g=this.getdataArrayValue(this._langridServiceInformations._sourceLanguageArray,c.lang1),
h=this.getdataArrayValue(this._CONST_FLOW_OPS,c.flow);c=c.lang4!=""?this.getdataArrayValue(this._langridServiceInformations._sourceLanguageArray,c.lang4):c.lang3!=""?this.getdataArrayValue(this._langridServiceInformations._sourceLanguageArray,c.lang3):this.getdataArrayValue(this._langridServiceInformations._sourceLanguageArray,c.lang2);var f=this._PanelMode=="new"?Const.Message.AddedMessage:Const.Message.SavedMessage;f=f.replace("%SRC",g);f=f.replace("%FLW",h);f=f.replace("%TGT",c);$A(b._PathArray).each(function(l){l.errorView(false);
e.contents[l.elementsIds.panel]&&e.contents[l.elementsIds.panel]!="undefined"&&e.contents[l.elementsIds.panel]!=""&&l.updatePrimaryId(e.contents[l.elementsIds.panel])});if(this._PanelMode=="new"){$("top-message-area").innerHTML=f;$("top-message-area").show();c=this._buildeData();g="W"+this._PathArray.length;h=new WebPathPanel;h.makeTranslationPathPanel_A(g,this._rootPanel,this._langridServiceInformations,this._PathArray,this._default_Settings,c);this._PathArray.push(h);for(c=0;c<this._PathArray.length;c++)if(this._PathArray[c]==
this){this._PathArray.splice(c,1);break}this._sortPanelArray()}else if(this._isDelete=="yes")for(c=0;c<this._PathArray.length;c++){if(this._PathArray[c]==this){this._PathArray.splice(c,1);break}}else{this.updateViewPanel();this.showMessageBox(f)}}}.bind(this),onFailure:function(c){$("tab5_error_message").innerHTML="<per>"+c.responseText+"</pre>"},onComplete:function(){$$(".nowedit").each(function(c){$(c.id+":edit")&&$(c.id+":edit").hide();$(c.id+":view")&&$(c.id+":view").show();Element.removeClassName(c,
"nowedit");var e=$(c.id+":save");Element.removeClassName(e,"btn");Element.addClassName(e,"btn-disable");$(c.id+":save-img").setAttribute("src",Const.Images.SaveOff)});if(this._PanelMode=="new"){this._addPanel.innerHTML="";this._addPanel.hide();$("div-add-path-area").show()}WebAddPathWorkspace._resetFilter()}.bind(this)})}});
